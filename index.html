
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Scouting Owl</title>

    <!-- Bootstrap core CSS -->
    <link href="dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <link href="../../assets/css/ie10-viewport-bug-workaround.css" rel="stylesheet"> -->

    <!-- Custom styles for this template -->
    <link href="starter-template.css" rel="stylesheet">

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!-- <script src="../../assets/js/ie-emulation-modes-warning.js"></script> -->
	<!-- Link to MathJax script from CDN -->
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>

<!-- Configuration script -->
    <script type="text/x-mathjax-config">
        //Note the above <script> attribute type="text/x-mathjax-config" 
            MathJax.Hub.Config({
                tex2jax: {inlineMath: [["$","$"],["\\(","\\)"]]}
            });
    </script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>

  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Scouting Owl</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
			<li><a href="#obj">Objective</a></li>
            <li><a href="#intro">Introduction</a></li>
            <li><a href="#harddesign">Hardware</a></li>
            <li><a href="#softdesign">Software</a></li>
            <li><a href="#testing">Testing</a></li>
            <li><a href="#result">Result</a></li>
			<li><a href="#conclusion">Conclusion</a></li>
			<li><a href="#future">Future Scope</a></li>
			<li><a href="#budget">Budget</a></li>
			<li><a href="#code">Code</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">

      <div class="starter-template">
        <h1>Rescue Robot: Scouting Owl</h1>
        <p class="lead">Robby Huang (lh479) | Parth Sarthi Sharma (pss242)
		<br>
		ECE 5725 | May 19, 2021</p>
      </div>

      <hr>
      <div class="center-block">
          <iframe width="640" height="360" src="https://www.youtube.com/embed/dQw4w9WgXcQ" frameborder="0" allowfullscreen></iframe>
          <h5 style="text-align:center;">Demonstration Video</h5>
      </div>

      <hr id="obj">

      <div style="text-align:center;">
              <h2>Project Objective</h2>
              <p style="text-align: justify;padding: 0px 30px;">In incidents such as gas leakage, nuclear explosion, or any environment that has potential threats to the life of the rescuer, a Scouting Owl can play an important role in searching for survivors and studying the hazardous conditions. Scouting Owl is a robot that allows the rescuer to detect and communicate with the survivor in an environment that is not yet suitable for in-person rescue.</p>
      </div>

    <hr id='intro'>

      <div class="row">
		<h2 style="text-align: center;">Introduction</h2>
          <div class="col-md-4" style="text-align:center;">
          <img class="img-rounded" src="pics/botImage.JPG" alt="Generic placeholder image" width="300" height="200">
          </div>
          <div style="text-align:center;">
          <p style="text-align: justify;padding: 0px 30px;">Scouting Owl is a robot that allows the rescuers to detect and communicate with the survivor in an environment that is not yet suitable for in-person rescue. To perform the critical rescue task, we built a Raspberry Pi 4 based robot with the following functions:</p>
          <ul>
			<li style="text-align: justify;">Establish a reliable half-duplex connection between the robot and the control device.</li>
			<li style="text-align: justify;">Fetch and display live IR camera feed along with sensor data on the display device.</li>
            <li style="text-align: justify;">Send commands from the control device to the robot.</li>
			<li style="text-align: justify;">Implement a function for the robot to map the surrounding area and display the map on the screen.</li>
          </ul>
          </div>
      </div>

    <hr id='harddesign'>

      <div style="text-align:center;">
              <h2>Hardware Design</h2>
			  <p style="text-align: justify;padding: 0px 30px;">The diagram below shows the wiring of our system. We used both 5V and 3.3V to power sensors depending on their operating voltage. For the sensor that is taking 5V, we use resistors to divide its output voltage to protect the GPIO pins on Raspberry Pi.</p>
			  <div style="text-align:center;">
				  <img class="img-rounded" src="pics/PiWithSensors.png" alt="Generic placeholder image" style="width:50%;">
				  <h5>Circuit connection of all the components</h5>
			  </div>
              <h4 style="text-align: justify;padding: 0px 30px;">Infrared Thermal Camera</h4>
			  <p style="text-align: justify;padding: 0px 30px;">To get a live feed of our surroundings, we used the Adafruit AMG8833 IR Thermal Camera. This camera module has 12 pins, out of which we only used 4. To get data from the camera, we used the I2C communication protocol. We also needed to install the "adafruit_amg88xx" library to use the module. Once running, the module returns an array of 64 individual infrared temperature readings over I2C. This module can measure temperatures ranging from 0°C to 80°C with an accuracy of +- 2.5°C making it ideal for our application. It can also detect a human from a distance of up to 7 meters. In order to get an image from the 8x8 array, we used image processing using the SciPy python library to interpolate the 8x8 grid. We used Fusion 360 to CAD an owl shape mounting mechanical to mount the IR camera securely and enhance the aesthetic of the robot.</p>
			  <div style="text-align:center;">
				  <img class="img-rounded" src="pics/IRCamera.jpg" alt="Generic placeholder image" style="width:30%;">
				  <h5>The IR Thermal Camera</h5>
			  </div>
			  
			  <p style="text-align: justify;padding: 0px 30px;">We used Fusion 360 to CAD an owl shape mechanical mount and 3D printed it to mount the IR camera securely and enhance the aesthetic of the robot.</p>
			  <div style="text-align:center;">
				  <img class="img-rounded" src="pics/IRMount.png" alt="Generic placeholder image" style="width:50%;">
				  <h5>The IR Camera Mount</h5>
			  </div>
			  
			  <br>
			  
			  <h4 style="text-align: justify;padding: 0px 30px;">Implementing Sensors</h4>
			  <p style="text-align: justify;padding: 0px 30px;">Along with the IR camera, our rescue robot is equipped with the following sensors:</p>
			  <ol>
				<li style="text-align: justify;">The flame sensor: We used the flame sensor to see if there is any fire nearby. If so, the rescuers are alerted about it on the display device. This sensor gives out a digital output corresponding to whether a fire is present or not. In order to receive the output, we used an edge-triggered callback function because it saves precious CPU cycles.</li>
				<div style="text-align:center;">
				  <img class="img-rounded" src="pics/flameSensor.jpg" alt="Generic placeholder image" style="width:20%;">
				  <h5>The Flame Sensor</h5>
				</div>
				<li style="text-align: justify;">The water sensor: We used the water sensor to see the presence of water. Since our robot is an electronic device, it is prone to short circuits when it comes in contact with water. Similar to the flame sensor, this sensor gives out a digital output corresponding to whether water is present or not. To receive the output, we used an edge-triggered callback function because it saves precious CPU cycles.</li>
				<div style="text-align:center;">
				  <img class="img-rounded" src="pics/waterSensor.jfif" alt="Generic placeholder image" style="width:20%;">
				  <h5>The Water Sensor</h5>
				</div>
				<p style="text-align: justify;padding: 0px 30px;">Initially, while testing the flame sensor we were using a piezo-electric barbeque lighter. We were hoping to see the results we wanted to see. However, we found out that the lighter triggered both flame and the water sensor and all for the wrong reasons. After debugging for hours, we found out that the lighter we were using generated thousands of volts for a short period which resulted in the generation of EM waves. These waves were intercepted by the wires acting as an antenna which triggered the interrupts.</p>
				<li style="text-align: justify;">The radiation sensor: We added a long wire connected to a free GPIO pin to utilize the above phenomenon. This wire acts as an antenna and can detect such bursts of radiation. To test our hypothesis, we hooked up the wire to an oscilloscope and tested the result. We found out that it does detect EM discharges.</li>
				<div style="text-align:center;">
				  <img class="img-rounded" src="pics/radiationSensor.png" alt="Generic placeholder image" style="width:50%;">
				  <h5>Radiation Output on the Oscilloscope</h5>
				</div>
				<li style="text-align: justify;">The temperature sensor: In order to get a measurement of the temperature, we used the LM393 temperature sensor. This sensor gives out a raw ADC value which needs to be converted into the corresponding temperature value using the expression: $$temperature = 10 * log_{10}(10000 * (\frac{3.3 * 1024}{adc} - 1)) - 10$$</li>
				<div style="text-align:center;">
				  <img class="img-rounded" src="pics/temperatureSensor.jfif" alt="Generic placeholder image" style="width:20%;">
				  <h5>The Temperature Sensor</h5>
				</div>
				<li style="text-align: justify;">The ultrasonic sensor: In order to keep a track of the distance, we used the HC-SR04 ultrasonic sensor. This sensor has a range of about 2 meters beyond which its accuracy starts decreasing rapidly. The purpose of this sensor is to avoid collisions and map the area around the robot.</li>
				<div style="text-align:center;">
				  <img class="img-rounded" src="pics/ultrasonicSensor.png" alt="Generic placeholder image" style="width:20%;">
				  <h5>The Ultrasonic Sensor</h5>
				</div>
				<p style="text-align: justify;padding: 0px 30px;">Moreover, we modularized the voltage divider part of our ultrasonic sensor and used a protoboard to provide both mechanical and electrical connections with the breadboard.</p>
				<div style="text-align:center;">
				  <img class="img-rounded" src="pics/ultrasonicMount.png" alt="Generic placeholder image" style="width:20%;">
				  <h5>The Modularized Ultrasonic Sensor</h5>
				</div>
			  </ol>
			  
			  <h4 style="text-align: justify;padding: 0px 30px;">The Speaker</h4>
			  <p style="text-align: justify;padding: 0px 30px;">In order to communicate with the person being rescued, we also added a Bluetooth speaker which can be controlled directly from the Python script. To play and record audio, the rescuer can simply tap the corresponding button on the screen and control the audio playback.</p>
      </div>

    <hr id='softdesign'>

      <div style="text-align:center;">
              <h2>Software Design</h2>
              <p style="text-align: justify;padding: 0px 30px;">The software design of the project consists of two main parts:</p>
			  <ul>
				<li style="text-align: justify;">The Python program running on the Raspberry Pi.</li>
				<li style="text-align: justify;">The Android application running on the user device.</li>
			  </ul>
			  <p style="text-align: justify;padding: 0px 30px;">The main architecture of the software design is based on the fact that the Android app and the Python program communicate with each other over a TCP/IP server. The Python program creates a TCP/IP server and opens up a socket for communication. Once the socket is created, it listens and waits for clients to connect to it. Once a client is connected to the server, the main Python program starts executing. During each cycle of execution, the data packet that is sent consists of the following components:</p>
			  <ul>
				<li style="text-align: justify;">The IR camera feed:</li>
				<ul>
					<li style="text-align: justify;">The pixel array</li>
					<li style="text-align: justify;">The bicubics array</li>
					<li style="text-align: justify;">The colour array</li>
				</ul>
				<li style="text-align: justify;">The sensor values:</li>
				<ul>
					<li style="text-align: justify;">The water sensor data</li>
					<li style="text-align: justify;">The fire sensor data</li>
					<li style="text-align: justify;">The radiation sensor data</li>
					<li style="text-align: justify;">The temperaure sensor data</li>
					<li style="text-align: justify;">The ultrasonic data</li>
				</ul>
			  </ul>
			  
			  <br>
			  
			  <h4 style="text-align: justify;padding: 0px 30px;">The Python Program</h4>
			  <p style="text-align: justify;padding: 0px 30px;">All these different data values are semi-colon (";") delimited and the values in the same data array are comma (",") delimited. All these data points are appended in a single string. The string is then encoded and sent over the TCP/IP socket. After sending the data, the server then waits for the commands from the client in a blocking manner. Once a string is received, the server decodes the string and changes the functions as per the received command.</p>
			  <div style="text-align:center;">
				  <img class="img-rounded" src="pics/pythonFlow.png" alt="Generic placeholder image" style="width:100%;">
				  <h5>The Flow Diagram for the Python Program</h5>
			  </div>
			  
			  <h5 style="text-align: justify;padding: 0px 30px;">The Ultrasonic Sensor</h5>	  
			  <p style="text-align: justify;padding: 0px 30px;">Ultrasonics sensor uses the time of flight of sound to measure distance. We sent a 0.01 millisecond pulse to the trigger pin of the ultrasonic sensor and took input from the echo pin. Then used the time difference between the trig output and echo input to calculate the distance traveled of the sound back and forth from the detected object and divided that by two. Then we simply used the expression: $$distance = speed \times time$$</p>
			  <div style="text-align:center;">
				  <img class="img-rounded" src="pics/ultrasonicTiming.png" alt="Generic placeholder image" style="width:40%;">
				  <h5>The Timing Diagram for the Ultrasonic Sensor</h5>
			  </div>
			  
			  <h5 style="text-align: justify;padding: 0px 30px;">The ADC</h5>	  
			  <p style="text-align: justify;padding: 0px 30px;">We used an MCP3008 to do the analog to digital conversion. It is an 8-channel, 10-bit analog to digital converter. ‘8 channel’ means that it can accept up to 8 different analog voltages. The 10-bit property is the resolution of the ADC, or the precision to which it can measure a voltage. Since the SPI library is broken, we had to implement it from scratch using bitbanging.</p>
			  <div style="text-align:center;">
				  <img class="img-rounded" src="pics/adcTiming.png" alt="Generic placeholder image" style="width:50%;">
				  <h5>The Timing Diagram for the ADC</h5>
			  </div>
			  
			  <h5 style="text-align: justify;padding: 0px 30px;">Mapping</h5>	  
			  <p style="text-align: justify;padding: 0px 30px;">Mapping using only the ultrasonic sensor was challenging as there was no feedback to test how much the robot has moved, so we needed to approach the problem creatively. Since the Scouting Owl is not equipped with localization sensors (IMU or GPS), we needed to make sure we know the robot's position for every measurement data. Therefore, we made the robot turn in place for a complete circle with a fixed number of sample points so that the robot is always at (0,0) and the position can be calculated using the linspace function.</p>
			  <div style="text-align:center;">
				  <img class="img-rounded" src="pics/mapRobot.jpg" alt="Generic placeholder image" style="width:50%;">
				  <h5>Mapping the Surrounding</h5>
			  </div>
			  <p style="text-align: justify;padding: 0px 30px;">With the robot position and the coordinate of the measurement point in the robotic frame, we are able to convert that coordinates into the global frame using a rotation matrix and map all of them.</p>
			  <div style="text-align:center;">
				  <img class="img-rounded" src="pics/coordChange.png" alt="Generic placeholder image" style="width:40%;">
				  <h5>Conversion of Robot Coordinates to Global Coordinates</h5>
			  </div>
			  
			  <br>
			  
			  <h4 style="text-align: justify;padding: 0px 30px;">The Android Application</h4>
			  <p style="text-align: justify;padding: 0px 30px;">The Android application works in a similar fashion. When the client starts, it searches for the server with given credentials. Once it is connected to the server, it waits for data to be received in a blocking manner. Once the data is received, the client decodes the data, splits it into IR camera feed and sensor values and updates the values on the screen. Once the screen has been updated, the client checks for button presses. If a button has been pressed, the client encodes the associated command and sends it over to the server. Otherwise, it encodes the stop command and send the command over to the said server.</p>
			  <div style="text-align:center;">
				  <img class="img-rounded" src="pics/javaFlow.png" alt="Generic placeholder image" style="width:100%;">
				  <h5>The Flow Diagram for the Android Application</h5>
			  </div>
			  
			  <p style="text-align: justify;padding: 0px 30px;">The Android application has a very minimalistic design. It shows the IR camera feed in the center with a data display panel. This panel is used to view the data received from all the sensors. It also has 10 buttons:</p>
			  <ul>
				<li style="text-align: justify;">UP: Pressing the UP button moves the robot forward.</li>
				<li style="text-align: justify;">DOWN: Pressing the DOWN button moves the robot backwards.</li>
				<li style="text-align: justify;">LEFT: Pressing the LEFT button rotates the robot in the counter-clockwise direction.</li>
				<li style="text-align: justify;">RIGHT: Pressing the RIGHT button rotates the robot in the clockwise direction.</li>
				<li style="text-align: justify;">INC: Pressing the INC button increases the robot move speed.</li>
				<li style="text-align: justify;">DEC: Pressing the DEC button reduces the robot move speed.</li>
				<li style="text-align: justify;">HELP: Pressing the HELP button plays a pre-recorded message.</li>
				<li style="text-align: justify;">RECORD: Pressing the RECORD button prompts the person being rescued to record their message.</li>
				<li style="text-align: justify;">PLAY: Pressing the PLAY button plays the sound recorded by the person being rescued.</li>
				<li style="text-align: justify;">MAP: Pressing the MAP button creates a map of the surrounding area.</li>
			  </ul>
			  <div style="text-align:center;">
				  <img class="img-rounded" src="pics/androidApp.png" alt="Generic placeholder image" style="width:70%;">
				  <h5>The Android Application</h5>
			  </div>
			  <p style="text-align: justify;padding: 0px 30px;">The biggest challenge while implementing the said algorithm was that the Wi-Fi router at our apartment was blocking the TCP/IP packets and therefore, wasn't allowing the connection between the server and the client to be established. In order to tackle this problem, we simply connected the RaspberryPi and the Android device to Cornell's open "RedRover". This allowed us to implement the system quite effectively.</p>
			  <p style="text-align: justify;padding: 0px 30px;">Another challenge we faced on the software side was that connecting to RedRover didn't allow us to update our kernel or install any new package. The reason behind this is that RedRover needs the users to login using Cornell NetID. Once logged in, we were able to use it like any other network.</p>
			  
      </div>

    <hr id='testing'>

      <div style="text-align:center;">
              <h2>Testing</h2>
			  <p style="text-align: justify;padding: 0px 30px;">To ensure that we keep making progress, we strictly followed this checklist so that we could have a smooth workflow and systematic approach to the overall objective.</p>
			  <div style="text-align:center;">
				  <img class="img-rounded" src="pics/testingTable.png" alt="Generic placeholder image" style="width:100%;">
			  </div>
			  
			  <br>
			  
              <p style="text-align: justify;padding: 0px 30px;">In order to see how well the system works, we tested each and every component quite extensively. We carried out the following tests:</p>
			  <ul>
				<li style="text-align: justify;">User control test: As a first step towards testing, we turned the power on and started the program. Then we tested out all the motion control buttons and verified that all the buttons are functioning as they should. We found out that there was a bit of latency bacause of large data packets being transmitted, but the robot was responding as it should.</li>
				<li style="text-align: justify;">Ultrasonic test: Next, we began testing the ultrasonic sensor to test the accuracy in the measurement of distance. Moreover, as a security feature, we also tested if the robot stops moving forward when the distance between an obstacle and the robot is less than a certain threshold value (15 cms in this case). The test revealed that the distance is accurate within 1 cm for a range of 4 cm to 200 cm. The distance is unmeasurable below 4 cm and the accuracy falls rapidly beyond 200 cm. Moreover, the robot does stop automatically and does not move forward when the distance goes below the set threshold.</li>
				<div style="text-align:center;">
				  <img class="img-rounded" src="pics/distanceTest.png" alt="Generic placeholder image" style="width:70%;">
				  <h5>Testing of the Ultrasonic Sensor</h5>
				</div>
				<li style="text-align: justify;">Flame test: The next sensor we tested was the flame sensor. In order to do so, we used a flint spark lighter and brought the flame close to the sensor. The main objective was to test how quickly the sensor reading changes in response to the flame and to figure out the maximum distance at which the flame is detected. The test revealed that the reading changes almost instantaneously in response to the flame. Also, the sensor is able to detect the lighter flame well over 1 meter when the flame is directly above the flame sensor. We also hypothesize that the distance will be even greater in case of larger flames. However, we did not have the required tools to safely test this out for larger flames.</li>
				<div style="text-align:center;">
				  <img class="img-rounded" src="pics/flameTest.png" alt="Generic placeholder image" style="width:70%;">
				  <h5>Testing of the Flame Sensor</h5>
				</div>
				<li style="text-align: justify;">Water test: In order to safely test the working of the water sensor, we used a cup of water and dipped the water sensor in the cup. The main idea was to test how quickly the sensor detects water. The test resulted in confirmation of the fact that the water is detected as soon as about 0.5 cm of the sensor is dipped in the water.</li>
				<div style="text-align:center;">
				  <img class="img-rounded" src="pics/waterTest.png" alt="Generic placeholder image" style="width:70%;">
				  <h5>Testing of the Water Sensor</h5>
				</div>
				<li style="text-align: justify;">Radiation test: In order to test the radiation, we used the piezo-electric barbeque lighter to generate a large voltage discharge. We found out that it was toggling the radiation flag quite effectively. However, there was an issue that it was also toggling the flame and water sensor flags. To avoid this, we simply toggled those flags back in the radiation sensor callback and it worked like a charm.</li>
				<div style="text-align:center;">
				  <img class="img-rounded" src="pics/radiationTest.png" alt="Generic placeholder image" style="width:70%;">
				  <h5>Testing of the Radiation Sensor</h5>
				</div>
				<li style="text-align: justify;">Mapping test: In order to test how well the mapping works, we placed the robot in a hallway and mapped the hallway for various locations quite extensively. The results of the mapping were generally quite decent with a few inaccuracies. However, the bigger picture was quite comprehensible and understandable.</li>
				<div style="text-align:center;">
				  <img class="img-rounded" src="pics/mappingTest.png" alt="Generic placeholder image" style="width:50%;">
				  <h5>Running the Map Test</h5>
				</div>
				<li style="text-align: justify;">Audio test: In order to test the audio output and input, we connected the bluetooth speaker to the RaspberryPi and played the audio files. We also tested the microphone input by recording the audio messages and playing them back. The audio recordings were quite legible.</li>
			  </ul>
      </div>

    <hr id='result'>

      <div style="text-align:center;">
              <h2>Result</h2>
              <p style="text-align: justify;padding: 0px 30px;">The project progressed mostly as we planned. We were able to implement all the sensors and features that we planned for. Moreover, we were also able to stay on track and save enough time to implement the mapping feature. We were able to develop the data packet structure to send data from server to client and get a response in return. Although there were a few hiccups like a few broken libraries and connection issues due to router blocking our TCP/IP packets, we were able to figure out the workarounds and stay on track in order to finish the project on time. We also managed to implement the mapping function which was very difficult to get right.</p>
      </div>
	  
	<hr id='conclusion'>

      <div style="text-align:center;">
              <h2>Conclusion</h2>
              <p style="text-align: justify;padding: 0px 30px;">We are proud that all features are well integrated and the user experience is decent. The user can remotely control the robot with their phone over a Wi-Fi network. The Scouting Owl keeps streaming its surroundings with the IR camera and constantly updates sensor information that benefits the rescuer: temperature, water level, and flame. It can even generate a clear local map with only the ultrasonic sensor and can establish back and forth conversations with the rescuee. All the features mentioned are well integrated into the concise Android application. Overall, our project covers a wide range of topics and requires skill sets from computer science (Application development, TCP/IP communication), electrical engineering (sensors, embedded system programming), and mechanical engineering (CAD, 3D printing).</p>
			  <p style="text-align: justify;padding: 0px 30px;">Despite accomplishments, we also learned a lot when getting stuck. We discovered that the communication between the Android device and the Raspberry Pi can not be established in a private Wi-Fi network. We found a lot of broken libraries when trying to integrate sensors which may suggest that a better solution may be using a microcontroller and establishing communication with it. Learning about the limitations and advantages of a Raspberry Pi will help us to make better design choices in future projects.</p>
      </div>
	
	<hr id='future'>

      <div style="text-align:center;">
              <h2>Future Scope</h2>
              <p style="text-align: justify;padding: 0px 30px;">Although Scouting Owl is in an amazing shape given that it is a month-long project, we can still elevate it in a lot of different ways:</p>
			  <ul>
				<li style="text-align: justify;">With the 8 channel ADC converter, we can include more analog sensors that tell us more information about the environment. For example, we can add photo-resistors, humidity sensor, and motion detector.</li>
				<li style="text-align: justify;">As mentioned above, Raspberry Pi is not ideal for directly interfacing with sensors, so using a microcontroller as a data acquisition board and communicating sensor readings with the Pi may be a more optimal and professional solution.</li>
				<li style="text-align: justify;">We can enhance mapping if we use a GPS or IMU to collect information and then use an Extended Kalman Filter to perform localization for the robot. In this way, we can create a much larger map. To map with higher precision, we can use the Intel real sense depth sensor that provides 9 depth measurement from 9 different angles at each time interval.</li>
				<li style="text-align: justify;">We can also implement a feedback mechanism from the motors to have a measure of how much each motor has turned in order to have precise movements.</li>
			  </ul>
      </div>
	
	<hr id='budget'>
	
	  <div style="text-align:center;">
              <h2>Budget</h2>
			  <ul>
				<li style="text-align: justify;">AMG8833 IR Thermal Camera: $26.99</li>
				<li style="text-align: justify;">Mini USB Microphone: $5.95</li>
				<li style="text-align: justify;">JBL Go Speaker: $10.00</li>
				<li style="text-align: justify;">Water Level Sensor, Flame Sensor, Analog Temperature Sensor Ultrasonic: $10.00</li>
				<li style="text-align: justify;">MCP3008: $3.75</li>
				<li style="text-align: justify;">Raspberry Pi 4: $35.00</li>
				<li style="text-align: justify;">Robot Kit: N/A</li>
				<li style="text-align: justify;">Overall: $91.69</li>
			  </ul>
      </div>

    <hr>

    <div class="row" style="text-align:center;">
          <h2>Work Distribution</h2>
          <div style="text-align:center;">
              <img class="img-rounded" src="pics/group.jpg" alt="Generic placeholder image" style="width:80%;">
              <h5>Project group picture</h5>
          </div>
          <div class="col-md-6" style="font-size:16px">
              <img class="img-rounded" src="pics/a.png" alt="Generic placeholder image" width="240" height="240">
              <h3>Robby Huang</h3>
              <p class="lead">lh479@cornell.edu</p>
              <p>Handled hardware assembly, 3D printing and individual sensor testing and voice communication.
          </div>
          <div class="col-md-6" style="font-size:16px">
              <img class="img-rounded" src="pics/b.png" alt="Generic placeholder image" width="240" height="240">
              <h3>Parth Sarthi Sharma</h3>
              <p class="lead">pss242@cornell.edu</p>
              <p>Handled TCP/IP communication, integration of sensors, motor control and android app development.
          </div>
      </div>

      <hr>
      <div style="text-align:justify;">
          <h2 style="text-align:center;">References</h2>
		  <a href="https://android.processing.org/">Processing (Software used for Android app development)</a><br>
          <a href="https://learn.adafruit.com/adafruit-amg8833-8x8-thermal-camera-sensor/raspberry-pi-thermal-camera">Thermal Camera Input</a><br>
          <a href="https://tutorials-raspberrypi.com/raspberry-pi-ultrasonic-sensor-hc-sr04/">Ultrasonic Sensor</a><br>
          <a href="https://learn.adafruit.com/usb-audio-cards-with-a-raspberry-pi/recording-audio">Audio Input</a><br>
          <a href="https://cdn-shop.adafruit.com/datasheets/MCP3008.pdf">ADC/SPI</a><br>
		  <a href="https://www.raspberrypi.org/documentation/hardware/raspberrypi/spi/README.md">ADC/SPI</a><br>
		  <a href="https://raspberrypi-aa.github.io/session3/spi.html">ADC/SPI</a><br>
          <a href="https://learn.sparkfun.com/tutorials/python-programming-tutorial-getting-started-with-the-raspberry-pi/experiment-2-play-sounds">Audio Output</a><br>

      </div>

    <hr id='code'>

      <div class="row">
              <h2 style="text-align:center;">Code Appendix</h2>
			  <h5 style="text-align:justify;">RobotRun.py</h5>
              <!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #888888">#Include all the libraries</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">RPi.GPIO</span> <span style="color: #008800; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">GPIO</span> <span style="color: #888888">#The GPIO library</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">time</span> <span style="color: #888888">#The time library</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">sys</span> <span style="color: #888888">#The sys library</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">os</span> <span style="color: #888888">#The os library</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">pygame</span> <span style="color: #888888">#The pygame library</span>
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">math</span> <span style="color: #008800; font-weight: bold">import</span> <span style="color: #333333">*</span> <span style="color: #888888">#The math library</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">numpy</span> <span style="color: #008800; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">np</span> <span style="color: #888888">#The numpy library</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">busio</span> <span style="color: #888888">#The bus input output library</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">board</span> <span style="color: #888888">#The board library</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">socket</span> <span style="color: #888888">#The TCP IP socket library</span>
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">scipy.interpolate</span> <span style="color: #008800; font-weight: bold">import</span> griddata <span style="color: #888888">#The scipy library</span>
<span style="color: #008800; font-weight: bold">from</span> <span style="color: #0e84b5; font-weight: bold">colour</span> <span style="color: #008800; font-weight: bold">import</span> Color <span style="color: #888888">#The colour library</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">adafruit_amg88xx</span> <span style="color: #888888">#The adafruit library for IR camera</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">matplotlib.pyplot</span> <span style="color: #008800; font-weight: bold">as</span> <span style="color: #0e84b5; font-weight: bold">plt</span> <span style="color: #888888">#The matplotlib library</span>

pygame<span style="color: #333333">.</span>mixer<span style="color: #333333">.</span>init() <span style="color: #888888">#Pygame mixer initialization for sounds</span>
GPIO<span style="color: #333333">.</span>setmode(GPIO<span style="color: #333333">.</span>BCM) <span style="color: #888888">#Set BCM for GPIO</span>

motor1PWMPin <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">26</span> <span style="color: #888888">#PWM Pin for motor 1</span>
motor1Pin1 <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">5</span> <span style="color: #888888">#Pin 1 for motor 1</span>
motor1Pin2 <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">6</span> <span style="color: #888888">#Pin 2 for motor 1</span>
motor2PWMPin <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">16</span> <span style="color: #888888">#PWM Pin for motor 2</span>
motor2Pin1 <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">20</span> <span style="color: #888888">#Pin 1 for motor 2</span>
motor2Pin2 <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">21</span> <span style="color: #888888">#Pin 2 for motor 2</span>

freq <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">50</span> <span style="color: #888888">#Set PWM frequency to 50 Hz</span>
dutyCycle <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">50</span> <span style="color: #888888">#Set default duty cycle to 50%</span>

CLK <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">11</span> <span style="color: #888888">#Clock pin for SPI</span>
MISO <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">9</span> <span style="color: #888888">#MISO pin for SPI</span>
MOSI <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">10</span> <span style="color: #888888">#MOSI pin for SPI</span>
CS <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">17</span> <span style="color: #888888">#Chip Select pin for SPI</span>

GPIO_TRIGGER <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">18</span> <span style="color: #888888">#Trigger pin for ultrasonic</span>
GPIO_ECHO <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">24</span> <span style="color: #888888">#Echo pin for ultrasonic</span>
GPIO_WATERLEVEL <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">22</span> <span style="color: #888888">#Pin for water level sensor</span>
GPIO_FLAME <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">13</span> <span style="color: #888888">#Pin for flame level sensor</span>
GPIO_ANTENNA <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">27</span> <span style="color: #888888">#Pin for sensing radiation</span>

GPIO<span style="color: #333333">.</span>setup(motor1PWMPin, GPIO<span style="color: #333333">.</span>OUT) <span style="color: #888888">#Setup motor 1 PWM pin as output</span>
GPIO<span style="color: #333333">.</span>setup(motor1Pin1, GPIO<span style="color: #333333">.</span>OUT) <span style="color: #888888">#Setup motor 1 pin 1 as output</span>
GPIO<span style="color: #333333">.</span>setup(motor1Pin2, GPIO<span style="color: #333333">.</span>OUT) <span style="color: #888888">#Setup motor 1 pin 2 as output</span>
GPIO<span style="color: #333333">.</span>setup(motor2PWMPin, GPIO<span style="color: #333333">.</span>OUT) <span style="color: #888888">#Setup motor 2 PWM pin as output</span>
GPIO<span style="color: #333333">.</span>setup(motor2Pin1, GPIO<span style="color: #333333">.</span>OUT) <span style="color: #888888">#Setup motor 2 pin 1 as output</span>
GPIO<span style="color: #333333">.</span>setup(motor2Pin2, GPIO<span style="color: #333333">.</span>OUT) <span style="color: #888888">#Setup motor 2 pin 2 as output</span>
GPIO<span style="color: #333333">.</span>output(motor1Pin1, GPIO<span style="color: #333333">.</span>LOW) <span style="color: #888888">#Set motor 1 pin 1 to be low</span>
GPIO<span style="color: #333333">.</span>output(motor1Pin2, GPIO<span style="color: #333333">.</span>LOW) <span style="color: #888888">#Set motor 1 pin 2 to be low</span>
GPIO<span style="color: #333333">.</span>output(motor2Pin1, GPIO<span style="color: #333333">.</span>LOW) <span style="color: #888888">#Set motor 2 pin 1 to be low</span>
GPIO<span style="color: #333333">.</span>output(motor2Pin2, GPIO<span style="color: #333333">.</span>LOW) <span style="color: #888888">#Set motor 2 pin 2 to be low</span>
motor1PWM <span style="color: #333333">=</span> GPIO<span style="color: #333333">.</span>PWM(motor1PWMPin, freq) <span style="color: #888888">#Initialize motor 1 PWM pin</span>
motor2PWM <span style="color: #333333">=</span> GPIO<span style="color: #333333">.</span>PWM(motor2PWMPin, freq) <span style="color: #888888">#Initialize motor 2 PWM pin</span>
motor1PWM<span style="color: #333333">.</span>start(dutyCycle) <span style="color: #888888">#Start motor 1 PWM with the given duty cycle</span>
motor2PWM<span style="color: #333333">.</span>start(dutyCycle) <span style="color: #888888">#Start motor 2 PWM with the given duty cycle</span>

GPIO<span style="color: #333333">.</span>setup(GPIO_TRIGGER, GPIO<span style="color: #333333">.</span>OUT) <span style="color: #888888">#Setup trigger pin as output</span>
GPIO<span style="color: #333333">.</span>setup(GPIO_ECHO, GPIO<span style="color: #333333">.</span>IN) <span style="color: #888888">#Setup echo pin as input</span>
GPIO<span style="color: #333333">.</span>setup(GPIO_WATERLEVEL, GPIO<span style="color: #333333">.</span>IN, pull_up_down <span style="color: #333333">=</span> GPIO<span style="color: #333333">.</span>PUD_DOWN) <span style="color: #888888">#Setup water level sensor pin as pulled down input</span>
GPIO<span style="color: #333333">.</span>setup(GPIO_FLAME, GPIO<span style="color: #333333">.</span>IN, pull_up_down <span style="color: #333333">=</span> GPIO<span style="color: #333333">.</span>PUD_DOWN) <span style="color: #888888">#Setup flame sensor pin as pulled down input</span>
GPIO<span style="color: #333333">.</span>setup(GPIO_ANTENNA, GPIO<span style="color: #333333">.</span>IN, pull_up_down <span style="color: #333333">=</span> GPIO<span style="color: #333333">.</span>PUD_DOWN) <span style="color: #888888">#Setup radiation sensor pin as pulled down input</span>

fireVar <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;No Fire&quot;</span> <span style="color: #888888">#Value for fire data to be sent</span>
waterVar <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;No Water&quot;</span> <span style="color: #888888">#Value for water data to be sent</span>
radiationVar <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;No Radiation&quot;</span> <span style="color: #888888">#Value for radiation data to be sent</span>

MINTEMP <span style="color: #333333">=</span> <span style="color: #6600EE; font-weight: bold">26.0</span> <span style="color: #888888">#Minimum temperature to be detected</span>
MAXTEMP <span style="color: #333333">=</span> <span style="color: #6600EE; font-weight: bold">32.0</span> <span style="color: #888888">#Maximum temperature to be detected</span>
COLORDEPTH <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">1024</span> <span style="color: #888888">#Colour depth to be 1024</span>

distVar <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">50</span> <span style="color: #888888">#Value for distance sensor</span>
tempVar <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">25</span> <span style="color: #888888">#Temperature data to be sent</span>
distToStop <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">15</span> <span style="color: #888888">#Distance threshold for the robot to stop</span>

command <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;STOP&quot;</span> <span style="color: #888888">#The command to control robot</span>
prevCommand <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;STOP&quot;</span> <span style="color: #888888">#The last received command</span>

<span style="color: #888888">#Constraint function to limit the value</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">constrain</span>(val, min_val, max_val):
    <span style="color: #008800; font-weight: bold">return</span> <span style="color: #007020">min</span>(max_val, <span style="color: #007020">max</span>(min_val, val))

<span style="color: #888888">#Function to fetch the distance from the ultrasonic sensor</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">distance</span>():
    GPIO<span style="color: #333333">.</span>output(GPIO_TRIGGER, <span style="color: #008800; font-weight: bold">True</span>)
    time<span style="color: #333333">.</span>sleep(<span style="color: #6600EE; font-weight: bold">0.00001</span>)
    GPIO<span style="color: #333333">.</span>output(GPIO_TRIGGER, <span style="color: #008800; font-weight: bold">False</span>)
    
    StartTime <span style="color: #333333">=</span> time<span style="color: #333333">.</span>time()
    StopTime <span style="color: #333333">=</span> time<span style="color: #333333">.</span>time()
    
    <span style="color: #008800; font-weight: bold">while</span> GPIO<span style="color: #333333">.</span>input(GPIO_ECHO) <span style="color: #333333">==</span> <span style="color: #0000DD; font-weight: bold">0</span>:
        StartTime <span style="color: #333333">=</span> time<span style="color: #333333">.</span>time()
 
    <span style="color: #008800; font-weight: bold">while</span> GPIO<span style="color: #333333">.</span>input(GPIO_ECHO) <span style="color: #333333">==</span> <span style="color: #0000DD; font-weight: bold">1</span>:
        StopTime <span style="color: #333333">=</span> time<span style="color: #333333">.</span>time()
 

    TimeElapsed <span style="color: #333333">=</span> StopTime <span style="color: #333333">-</span> StartTime
    distance <span style="color: #333333">=</span> (TimeElapsed <span style="color: #333333">*</span> <span style="color: #0000DD; font-weight: bold">34300</span>) <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span>
    <span style="color: #008800; font-weight: bold">return</span> distance

<span style="color: #888888">#Function to convert robot coordinates to global coordinates</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">robot2global</span>(pose, xyR):
    theta <span style="color: #333333">=</span> pose[<span style="color: #0000DD; font-weight: bold">2</span>]
    Trg <span style="color: #333333">=</span> [[cos(theta), <span style="color: #333333">-</span>sin(theta), pose[<span style="color: #0000DD; font-weight: bold">0</span>]],
           [sin(theta), cos(theta), pose[<span style="color: #0000DD; font-weight: bold">1</span>]],
           [<span style="color: #0000DD; font-weight: bold">0</span>, <span style="color: #0000DD; font-weight: bold">0</span>, <span style="color: #0000DD; font-weight: bold">1</span>]]
    Trg <span style="color: #333333">=</span> np<span style="color: #333333">.</span>array(Trg)
    xyR<span style="color: #333333">.</span>append(<span style="color: #0000DD; font-weight: bold">1</span>)
    xyR <span style="color: #333333">=</span> np<span style="color: #333333">.</span>array(xyR)
    xyG <span style="color: #333333">=</span> np<span style="color: #333333">.</span>matmul(Trg, xyR<span style="color: #333333">.</span>transpose())
    xyG <span style="color: #333333">=</span> xyG[<span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">2</span>]
    <span style="color: #008800; font-weight: bold">return</span> xyG

<span style="color: #888888">#The mapping function</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">startMap</span>():
    <span style="color: #008800; font-weight: bold">global</span> dutyCycle, motor1Pin1, motor1Pin2, motor2Pin1, motor2Pin2, motor1PWM, motor2PWM
    
    <span style="color: #888888">#Change the duty cycle to 100%</span>
    motor1PWM<span style="color: #333333">.</span>ChangeDutyCycle(<span style="color: #0000DD; font-weight: bold">100</span>)
    motor2PWM<span style="color: #333333">.</span>ChangeDutyCycle(<span style="color: #0000DD; font-weight: bold">100</span>)
    
    distArray <span style="color: #333333">=</span> []
    sensorOrigin <span style="color: #333333">=</span> [<span style="color: #6600EE; font-weight: bold">10.8</span>, <span style="color: #0000DD; font-weight: bold">0</span>]
    numPt <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">200</span> <span style="color: #888888">#Number of points to be plotted</span>
    theta <span style="color: #333333">=</span> np<span style="color: #333333">.</span>linspace(<span style="color: #0000DD; font-weight: bold">0</span>, <span style="color: #0000DD; font-weight: bold">2</span> <span style="color: #333333">*</span> pi, numPt)
    
    <span style="color: #888888">#Fetch the distance for all the points</span>
    <span style="color: #008800; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #0000DD; font-weight: bold">0</span>, numPt):
        GPIO<span style="color: #333333">.</span>output(motor1Pin1, GPIO<span style="color: #333333">.</span>HIGH)
        GPIO<span style="color: #333333">.</span>output(motor1Pin2, GPIO<span style="color: #333333">.</span>LOW)
        GPIO<span style="color: #333333">.</span>output(motor2Pin1, GPIO<span style="color: #333333">.</span>HIGH)
        GPIO<span style="color: #333333">.</span>output(motor2Pin2, GPIO<span style="color: #333333">.</span>LOW)
        time<span style="color: #333333">.</span>sleep(<span style="color: #6600EE; font-weight: bold">0.01</span>)
        GPIO<span style="color: #333333">.</span>output(motor1Pin1,GPIO<span style="color: #333333">.</span>LOW)
        GPIO<span style="color: #333333">.</span>output(motor1Pin2,GPIO<span style="color: #333333">.</span>LOW)
        GPIO<span style="color: #333333">.</span>output(motor2Pin1,GPIO<span style="color: #333333">.</span>LOW)
        GPIO<span style="color: #333333">.</span>output(motor2Pin2,GPIO<span style="color: #333333">.</span>LOW)
        time<span style="color: #333333">.</span>sleep(<span style="color: #6600EE; font-weight: bold">0.1</span>)
        distArray<span style="color: #333333">.</span>append(distance())
    xVal <span style="color: #333333">=</span> []
    yVal <span style="color: #333333">=</span> []
    <span style="color: #008800; font-weight: bold">for</span> i <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #0000DD; font-weight: bold">0</span>, numPt):
        dpy <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>
        dpx <span style="color: #333333">=</span> distArray[i] <span style="color: #333333">+</span> sensorOrigin[<span style="color: #0000DD; font-weight: bold">0</span>]
        depthPtG <span style="color: #333333">=</span> robot2global([<span style="color: #0000DD; font-weight: bold">0</span>,<span style="color: #0000DD; font-weight: bold">0</span>,theta[i]], [dpx, dpy])
        xVal<span style="color: #333333">.</span>append(depthPtG[<span style="color: #0000DD; font-weight: bold">0</span>])
        yVal<span style="color: #333333">.</span>append(depthPtG[<span style="color: #0000DD; font-weight: bold">1</span>])
    plt<span style="color: #333333">.</span>plot(<span style="color: #0000DD; font-weight: bold">0</span>, <span style="color: #0000DD; font-weight: bold">0</span>, <span style="background-color: #fff0f0">&#39;r+&#39;</span>) <span style="color: #888888">#Plot the bot as a red +</span>
    plt<span style="color: #333333">.</span>plot(xVal, yVal, <span style="background-color: #fff0f0">&#39;bo&#39;</span>) <span style="color: #888888">#Plot the distances as blue circles</span>
    plt<span style="color: #333333">.</span>show() <span style="color: #888888">#Show the plot</span>
    <span style="color: #888888">#Change the duty cycle back</span>
    motor1PWM<span style="color: #333333">.</span>ChangeDutyCycle(dutyCycle)
    motor2PWM<span style="color: #333333">.</span>ChangeDutyCycle(dutyCycle)

<span style="color: #888888">#Function to map a value in a given range</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">map_value</span>(x, in_min, in_max, out_min, out_max):
    <span style="color: #008800; font-weight: bold">return</span> (x <span style="color: #333333">-</span> in_min) <span style="color: #333333">*</span> (out_max <span style="color: #333333">-</span> out_min) <span style="color: #333333">/</span> (in_max <span style="color: #333333">-</span> in_min) <span style="color: #333333">+</span> out_min

<span style="color: #888888">#Setup the SPI pins</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">setupSpiPins</span>(clkPin, misoPin, mosiPin, csPin):
    GPIO<span style="color: #333333">.</span>setup(clkPin, GPIO<span style="color: #333333">.</span>OUT)
    GPIO<span style="color: #333333">.</span>setup(misoPin, GPIO<span style="color: #333333">.</span>IN)
    GPIO<span style="color: #333333">.</span>setup(mosiPin, GPIO<span style="color: #333333">.</span>OUT)
    GPIO<span style="color: #333333">.</span>setup(csPin, GPIO<span style="color: #333333">.</span>OUT)
     
<span style="color: #888888">#Read the ADC values using SPI</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">readAdc</span>(channel, clkPin, misoPin, mosiPin, csPin):
    <span style="color: #008800; font-weight: bold">if</span> (channel <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">0</span>) <span style="color: #000000; font-weight: bold">or</span> (channel <span style="color: #333333">&gt;</span> <span style="color: #0000DD; font-weight: bold">7</span>):
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">&quot;Invalid ADC Channel number, must be between [0,7]&quot;</span>)
        <span style="color: #008800; font-weight: bold">return</span> <span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">1</span>
        
    GPIO<span style="color: #333333">.</span>output(csPin, GPIO<span style="color: #333333">.</span>HIGH)
    GPIO<span style="color: #333333">.</span>output(csPin, GPIO<span style="color: #333333">.</span>LOW)
    GPIO<span style="color: #333333">.</span>output(clkPin, GPIO<span style="color: #333333">.</span>HIGH)
    read_command <span style="color: #333333">=</span> <span style="color: #005588; font-weight: bold">0x18</span>
    read_command <span style="color: #333333">|=</span> channel
    
    sendBits(read_command, <span style="color: #0000DD; font-weight: bold">5</span>, clkPin, mosiPin)
    
    adcValue <span style="color: #333333">=</span> recvBits(<span style="color: #0000DD; font-weight: bold">12</span>, clkPin, misoPin)
    GPIO<span style="color: #333333">.</span>output(csPin, GPIO<span style="color: #333333">.</span>HIGH)
    <span style="color: #008800; font-weight: bold">return</span> adcValue

<span style="color: #888888">#Send the bits    </span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">sendBits</span>(data, numBits, clkPin, mosiPin):
    data <span style="color: #333333">&lt;&lt;=</span> (<span style="color: #0000DD; font-weight: bold">8</span> <span style="color: #333333">-</span> numBits)
    
    <span style="color: #008800; font-weight: bold">for</span> bit <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">range</span>(numBits):
        <span style="color: #008800; font-weight: bold">if</span> data <span style="color: #333333">&amp;</span> <span style="color: #005588; font-weight: bold">0x80</span>:
            GPIO<span style="color: #333333">.</span>output(mosiPin, GPIO<span style="color: #333333">.</span>HIGH)
        <span style="color: #008800; font-weight: bold">else</span>:
            GPIO<span style="color: #333333">.</span>output(mosiPin, GPIO<span style="color: #333333">.</span>LOW)
        data <span style="color: #333333">&lt;&lt;=</span> <span style="color: #0000DD; font-weight: bold">1</span>
        
        GPIO<span style="color: #333333">.</span>output(clkPin, GPIO<span style="color: #333333">.</span>HIGH)
        GPIO<span style="color: #333333">.</span>output(clkPin, GPIO<span style="color: #333333">.</span>LOW)

<span style="color: #888888">#Receive the data bits</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">recvBits</span>(numBits, clkPin, misoPin):
    retVal <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span>
    
    <span style="color: #008800; font-weight: bold">for</span> bit <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">range</span>(numBits):
        GPIO<span style="color: #333333">.</span>output(clkPin, GPIO<span style="color: #333333">.</span>HIGH)
        GPIO<span style="color: #333333">.</span>output(clkPin, GPIO<span style="color: #333333">.</span>LOW)
        <span style="color: #008800; font-weight: bold">if</span> GPIO<span style="color: #333333">.</span>input(misoPin):
            retVal <span style="color: #333333">|=</span> <span style="color: #005588; font-weight: bold">0x1</span>
        
        retVal <span style="color: #333333">&lt;&lt;=</span> <span style="color: #0000DD; font-weight: bold">1</span>
    
    <span style="color: #008800; font-weight: bold">return</span> (retVal<span style="color: #333333">/</span><span style="color: #0000DD; font-weight: bold">2</span>)

<span style="color: #888888">#Callback function for water level sensor</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">trigWater</span>(channel):
    <span style="color: #008800; font-weight: bold">global</span> waterVar
    <span style="color: #008800; font-weight: bold">if</span>(waterVar <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;Water&quot;</span>):
        waterVar <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;No Water&quot;</span>
    <span style="color: #008800; font-weight: bold">else</span>:
        waterVar <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;Water&quot;</span>

<span style="color: #888888">#Callback function for fire sensor    </span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">trigFire</span>(channel):
    <span style="color: #008800; font-weight: bold">global</span> fireVar
    <span style="color: #008800; font-weight: bold">if</span>(fireVar <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;Fire&quot;</span>):
        fireVar <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;No Fire&quot;</span>
    <span style="color: #008800; font-weight: bold">else</span>:
        fireVar <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;Fire&quot;</span>

<span style="color: #888888">#Callback function for radiation sensor</span>
<span style="color: #008800; font-weight: bold">def</span> <span style="color: #0066BB; font-weight: bold">trigRadiation</span>(channel):
    <span style="color: #008800; font-weight: bold">global</span> radiationVar, fireVar, waterVar
    radiationVar <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;Radiation&quot;</span>
    <span style="color: #008800; font-weight: bold">if</span>(fireVar <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;Fire&quot;</span>):
        fireVar <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;No Fire&quot;</span>
    <span style="color: #008800; font-weight: bold">else</span>:
        fireVar <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;Fire&quot;</span>
    <span style="color: #008800; font-weight: bold">if</span>(waterVar <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;Water&quot;</span>):
        waterVar <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;No Water&quot;</span>
    <span style="color: #008800; font-weight: bold">else</span>:
        waterVar <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;Water&quot;</span>

i2c_bus <span style="color: #333333">=</span> busio<span style="color: #333333">.</span>I2C(board<span style="color: #333333">.</span>SCL, board<span style="color: #333333">.</span>SDA) <span style="color: #888888">#Setup the I2C bus</span>
sensor <span style="color: #333333">=</span> adafruit_amg88xx<span style="color: #333333">.</span>AMG88XX(i2c_bus) <span style="color: #888888">#Setup the IR sensor using I2C</span>

points <span style="color: #333333">=</span> [(floor(ix <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">8</span>), (ix <span style="color: #333333">%</span> <span style="color: #0000DD; font-weight: bold">8</span>)) <span style="color: #008800; font-weight: bold">for</span> ix <span style="color: #000000; font-weight: bold">in</span> <span style="color: #007020">range</span>(<span style="color: #0000DD; font-weight: bold">0</span>, <span style="color: #0000DD; font-weight: bold">64</span>)] <span style="color: #888888">#Points for the IR sensor</span>
grid_x, grid_y <span style="color: #333333">=</span> np<span style="color: #333333">.</span>mgrid[<span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">7</span>:<span style="color: #0000DD; font-weight: bold">32</span>j, <span style="color: #0000DD; font-weight: bold">0</span>:<span style="color: #0000DD; font-weight: bold">7</span>:<span style="color: #0000DD; font-weight: bold">32</span>j] <span style="color: #888888">#Create the grid</span>

blue <span style="color: #333333">=</span> Color(<span style="background-color: #fff0f0">&quot;indigo&quot;</span>) <span style="color: #888888">#The colour blue</span>
colors <span style="color: #333333">=</span> <span style="color: #007020">list</span>(blue<span style="color: #333333">.</span>range_to(Color(<span style="background-color: #fff0f0">&quot;red&quot;</span>), COLORDEPTH)) <span style="color: #888888">#The colours list</span>
colors <span style="color: #333333">=</span> [(<span style="color: #007020">int</span>(c<span style="color: #333333">.</span>red <span style="color: #333333">*</span> <span style="color: #0000DD; font-weight: bold">255</span>), <span style="color: #007020">int</span>(c<span style="color: #333333">.</span>green <span style="color: #333333">*</span> <span style="color: #0000DD; font-weight: bold">255</span>), <span style="color: #007020">int</span>(c<span style="color: #333333">.</span>blue <span style="color: #333333">*</span> <span style="color: #0000DD; font-weight: bold">255</span>)) <span style="color: #008800; font-weight: bold">for</span> c <span style="color: #000000; font-weight: bold">in</span> colors]

time<span style="color: #333333">.</span>sleep(<span style="color: #6600EE; font-weight: bold">0.1</span>) <span style="color: #888888">#Do not remove. Lets sensor initialize</span>

GPIO<span style="color: #333333">.</span>add_event_detect(GPIO_WATERLEVEL, GPIO<span style="color: #333333">.</span>BOTH, callback <span style="color: #333333">=</span> trigWater, bouncetime <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">300</span>) <span style="color: #888888">#The event detection for water level sensor</span>
GPIO<span style="color: #333333">.</span>add_event_detect(GPIO_FLAME, GPIO<span style="color: #333333">.</span>BOTH, callback <span style="color: #333333">=</span> trigFire, bouncetime <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">300</span>) <span style="color: #888888">#The event detection for fire sensor</span>
GPIO<span style="color: #333333">.</span>add_event_detect(GPIO_ANTENNA, GPIO<span style="color: #333333">.</span>BOTH, callback <span style="color: #333333">=</span> trigRadiation, bouncetime <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">300</span>) <span style="color: #888888">#The event detection for radiation detection sensor</span>

timeStamp <span style="color: #333333">=</span> time<span style="color: #333333">.</span>time() <span style="color: #888888">#The start time flag</span>

<span style="color: #008800; font-weight: bold">if</span> __name__ <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&#39;__main__&#39;</span>:
    <span style="color: #008800; font-weight: bold">try</span>:
        setupSpiPins(CLK, MISO, MOSI, CS) <span style="color: #888888">#Call the SPI setup function</span>
        HOST <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&#39;10.49.32.252&#39;</span> <span style="color: #888888">#The server IP address (RaspberryPi in this case)</span>
        PORT <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">8000</span> <span style="color: #888888">#The port for the socket</span>
        <span style="color: #007020">print</span>(socket<span style="color: #333333">.</span>gethostname()) <span style="color: #888888">#Print the hostname</span>
        s <span style="color: #333333">=</span> socket<span style="color: #333333">.</span>socket(socket<span style="color: #333333">.</span>AF_INET, socket<span style="color: #333333">.</span>SOCK_STREAM) <span style="color: #888888">#Start the socket</span>
        s<span style="color: #333333">.</span>setsockopt(socket<span style="color: #333333">.</span>SOL_SOCKET, socket<span style="color: #333333">.</span>SO_REUSEADDR, <span style="color: #0000DD; font-weight: bold">1</span>) <span style="color: #888888">#Configure the socket</span>
        s<span style="color: #333333">.</span>bind((HOST, PORT)) <span style="color: #888888">#Bind the socket</span>
        s<span style="color: #333333">.</span>listen(<span style="color: #0000DD; font-weight: bold">5</span>) <span style="color: #888888">#Listen for clients</span>
        conn, addr <span style="color: #333333">=</span> s<span style="color: #333333">.</span>accept() <span style="color: #888888">#Accept the connection</span>
        <span style="color: #007020">print</span>(addr) <span style="color: #888888">#Print the address of the connected clients</span>

        connected <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">False</span> <span style="color: #888888">#The connected flag</span>
    
        <span style="color: #008800; font-weight: bold">while</span> <span style="color: #008800; font-weight: bold">True</span>: <span style="color: #888888">#While infinity</span>
            connected <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">False</span> <span style="color: #888888">#Default the connected flag to false</span>
            pixels <span style="color: #333333">=</span> [] <span style="color: #888888">#The pixels array</span>
            <span style="color: #008800; font-weight: bold">for</span> row <span style="color: #000000; font-weight: bold">in</span> sensor<span style="color: #333333">.</span>pixels:
                pixels <span style="color: #333333">=</span> pixels <span style="color: #333333">+</span> row
            pixels <span style="color: #333333">=</span> [map_value(p, MINTEMP, MAXTEMP, <span style="color: #0000DD; font-weight: bold">0</span>, COLORDEPTH <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span>) <span style="color: #008800; font-weight: bold">for</span> p <span style="color: #000000; font-weight: bold">in</span> pixels]

            bicubic <span style="color: #333333">=</span> griddata(points, pixels, (grid_x, grid_y), method<span style="color: #333333">=</span><span style="background-color: #fff0f0">&quot;cubic&quot;</span>)

            data <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;&quot;</span> <span style="color: #888888">#The data to be transmitted</span>
            <span style="color: #008800; font-weight: bold">for</span> pixel <span style="color: #000000; font-weight: bold">in</span> pixels: <span style="color: #888888">#Append the pixels to the data to be transmitted with a &#39;,&#39; delimiter</span>
                data <span style="color: #333333">=</span> data <span style="color: #333333">+</span> <span style="color: #007020">str</span>(pixel) <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;,&quot;</span>
            data <span style="color: #333333">=</span> data <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;;&quot;</span>  <span style="color: #888888">#Append the &#39;;&#39; delimiter</span>
            <span style="color: #008800; font-weight: bold">for</span> bi <span style="color: #000000; font-weight: bold">in</span> bicubic: <span style="color: #888888">#Append the bicubic to the data to be transmitted with a &#39;,&#39; delimiter</span>
                <span style="color: #008800; font-weight: bold">for</span> b <span style="color: #000000; font-weight: bold">in</span> bi:
                    data <span style="color: #333333">=</span> data <span style="color: #333333">+</span> <span style="color: #007020">str</span>(b) <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;,&quot;</span>
            data <span style="color: #333333">=</span> data <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;;&quot;</span> <span style="color: #888888">#Append the &#39;;&#39; delimiter</span>
            <span style="color: #008800; font-weight: bold">for</span> color <span style="color: #000000; font-weight: bold">in</span> colors: <span style="color: #888888">#Append the color to the data to be transmitted with a &#39;:&#39; delimiter</span>
                data <span style="color: #333333">=</span> data <span style="color: #333333">+</span> <span style="color: #007020">str</span>(color) <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;:&quot;</span>
            data <span style="color: #333333">=</span> data <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;;&quot;</span> <span style="color: #888888">#Append the &#39;;&#39; delimiter</span>
            data <span style="color: #333333">=</span> data <span style="color: #333333">+</span> waterVar <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;,&quot;</span> <span style="color: #333333">+</span> fireVar <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;,&quot;</span> <span style="color: #333333">+</span> radiationVar <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;,&quot;</span> <span style="color: #333333">+</span> <span style="color: #007020">str</span>(tempVar) <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;,&quot;</span> <span style="color: #333333">+</span> <span style="color: #007020">str</span>(distVar) <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;;&quot;</span> <span style="color: #888888">#Append the sensor data to the data to be transmitted with a &#39;,&#39; delimiter</span>
            <span style="color: #008800; font-weight: bold">try</span>:
                conn<span style="color: #333333">.</span>send((data <span style="color: #333333">+</span> <span style="background-color: #fff0f0">&quot;</span><span style="color: #666666; font-weight: bold; background-color: #fff0f0">\n</span><span style="background-color: #fff0f0">&quot;</span>)<span style="color: #333333">.</span>encode()) <span style="color: #888888">#Encode the data and transmit over TCP/IP connection</span>
                connected <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">True</span> <span style="color: #888888">#If no error is thrown, mark the connected flag as true</span>
            <span style="color: #008800; font-weight: bold">except</span>: <span style="color: #888888">#If an error is thrown</span>
                <span style="color: #888888">#Try reconnecting</span>
                s <span style="color: #333333">=</span> socket<span style="color: #333333">.</span>socket(socket<span style="color: #333333">.</span>AF_INET, socket<span style="color: #333333">.</span>SOCK_STREAM)
                s<span style="color: #333333">.</span>setsockopt(socket<span style="color: #333333">.</span>SOL_SOCKET, socket<span style="color: #333333">.</span>SO_REUSEADDR, <span style="color: #0000DD; font-weight: bold">1</span>)
                s<span style="color: #333333">.</span>bind((HOST, PORT))
                s<span style="color: #333333">.</span>listen(<span style="color: #0000DD; font-weight: bold">5</span>)
                conn, addr <span style="color: #333333">=</span> s<span style="color: #333333">.</span>accept()
                <span style="color: #007020">print</span>(addr)
                connected <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">True</span> <span style="color: #888888">#Mark the connected flag as true</span>
            <span style="color: #008800; font-weight: bold">if</span> connected: <span style="color: #888888">#If connected</span>
                <span style="color: #008800; font-weight: bold">try</span>:
                    command <span style="color: #333333">=</span> conn<span style="color: #333333">.</span>recv(<span style="color: #0000DD; font-weight: bold">1024</span>) <span style="color: #888888">#Receive the data from clients</span>
                    command <span style="color: #333333">=</span> command<span style="color: #333333">.</span>decode()<span style="color: #333333">.</span>strip() <span style="color: #888888">#If the data is received, decode the command, then strip all the whitespaces</span>
                <span style="color: #008800; font-weight: bold">except</span>: <span style="color: #888888">#If the data reception fails</span>
                    connected <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">False</span> <span style="color: #888888">#Mark the connected flag as false</span>
            <span style="color: #008800; font-weight: bold">if</span>(command <span style="color: #333333">!=</span> prevCommand): <span style="color: #888888">#If the command has changed</span>
                <span style="color: #007020">print</span>(command) <span style="color: #888888">#Print the new command</span>
                
            <span style="color: #008800; font-weight: bold">if</span>(command <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;STOP&quot;</span> <span style="color: #000000; font-weight: bold">and</span> prevCommand <span style="color: #333333">!=</span> <span style="background-color: #fff0f0">&quot;STOP&quot;</span>): <span style="color: #888888">#If the new command is STOP</span>
                GPIO<span style="color: #333333">.</span>output(motor1Pin1, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor1Pin2, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor2Pin1, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor2Pin2, GPIO<span style="color: #333333">.</span>LOW)
            <span style="color: #008800; font-weight: bold">elif</span>(command <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;UP&quot;</span> <span style="color: #000000; font-weight: bold">and</span> prevCommand <span style="color: #333333">!=</span> <span style="background-color: #fff0f0">&quot;UP&quot;</span>): <span style="color: #888888">#If the new command is UP</span>
                <span style="color: #008800; font-weight: bold">if</span> distVar <span style="color: #333333">&gt;</span> distToStop: <span style="color: #888888">#If the distance is greater than the threshold value</span>
                    GPIO<span style="color: #333333">.</span>output(motor1Pin1, GPIO<span style="color: #333333">.</span>LOW)
                    GPIO<span style="color: #333333">.</span>output(motor1Pin2, GPIO<span style="color: #333333">.</span>HIGH)
                    GPIO<span style="color: #333333">.</span>output(motor2Pin1, GPIO<span style="color: #333333">.</span>HIGH)
                    GPIO<span style="color: #333333">.</span>output(motor2Pin2, GPIO<span style="color: #333333">.</span>LOW)
                <span style="color: #008800; font-weight: bold">else</span>:
                    GPIO<span style="color: #333333">.</span>output(motor1Pin1, GPIO<span style="color: #333333">.</span>LOW)
                    GPIO<span style="color: #333333">.</span>output(motor1Pin2, GPIO<span style="color: #333333">.</span>LOW)
                    GPIO<span style="color: #333333">.</span>output(motor2Pin1, GPIO<span style="color: #333333">.</span>LOW)
                    GPIO<span style="color: #333333">.</span>output(motor2Pin2, GPIO<span style="color: #333333">.</span>LOW)
            <span style="color: #008800; font-weight: bold">elif</span>(command <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;DOWN&quot;</span> <span style="color: #000000; font-weight: bold">and</span> prevCommand <span style="color: #333333">!=</span> <span style="background-color: #fff0f0">&quot;DOWN&quot;</span>): <span style="color: #888888">#If the new command is DOWN</span>
                GPIO<span style="color: #333333">.</span>output(motor1Pin1, GPIO<span style="color: #333333">.</span>HIGH)
                GPIO<span style="color: #333333">.</span>output(motor1Pin2, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor2Pin1, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor2Pin2, GPIO<span style="color: #333333">.</span>HIGH)
            <span style="color: #008800; font-weight: bold">elif</span>(command <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;LEFT&quot;</span> <span style="color: #000000; font-weight: bold">and</span> prevCommand <span style="color: #333333">!=</span> <span style="background-color: #fff0f0">&quot;LEFT&quot;</span>): <span style="color: #888888">#If the new command is LEFT</span>
                GPIO<span style="color: #333333">.</span>output(motor1Pin1, GPIO<span style="color: #333333">.</span>HIGH)
                GPIO<span style="color: #333333">.</span>output(motor1Pin2, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor2Pin1, GPIO<span style="color: #333333">.</span>HIGH)
                GPIO<span style="color: #333333">.</span>output(motor2Pin2, GPIO<span style="color: #333333">.</span>LOW)
            <span style="color: #008800; font-weight: bold">elif</span>(command <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;RIGHT&quot;</span> <span style="color: #000000; font-weight: bold">and</span> prevCommand <span style="color: #333333">!=</span> <span style="background-color: #fff0f0">&quot;RIGHT&quot;</span>): <span style="color: #888888">#If the new command is RIGHT</span>
                GPIO<span style="color: #333333">.</span>output(motor1Pin1, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor1Pin2, GPIO<span style="color: #333333">.</span>HIGH)
                GPIO<span style="color: #333333">.</span>output(motor2Pin1, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor2Pin2, GPIO<span style="color: #333333">.</span>HIGH)
            <span style="color: #008800; font-weight: bold">elif</span>(command <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;HELP&quot;</span> <span style="color: #000000; font-weight: bold">and</span> prevCommand <span style="color: #333333">!=</span> <span style="background-color: #fff0f0">&quot;HELP&quot;</span>): <span style="color: #888888">#If the new command is HELP</span>
                GPIO<span style="color: #333333">.</span>output(motor1Pin1, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor1Pin2, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor2Pin1, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor2Pin2, GPIO<span style="color: #333333">.</span>LOW)
                pygame<span style="color: #333333">.</span>mixer<span style="color: #333333">.</span>music<span style="color: #333333">.</span>load(<span style="background-color: #fff0f0">&quot;help.wav&quot;</span>) <span style="color: #888888">#Load the audio file</span>
                pygame<span style="color: #333333">.</span>mixer<span style="color: #333333">.</span>music<span style="color: #333333">.</span>play() <span style="color: #888888">#Play the audio file</span>
            <span style="color: #008800; font-weight: bold">elif</span>(command <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;RECORD&quot;</span> <span style="color: #000000; font-weight: bold">and</span> prevCommand <span style="color: #333333">!=</span> <span style="background-color: #fff0f0">&quot;RECORD&quot;</span>): <span style="color: #888888">#If the new command is RECORD</span>
                GPIO<span style="color: #333333">.</span>output(motor1Pin1, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor1Pin2, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor2Pin1, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor2Pin2, GPIO<span style="color: #333333">.</span>LOW)
                pygame<span style="color: #333333">.</span>mixer<span style="color: #333333">.</span>music<span style="color: #333333">.</span>load(<span style="background-color: #fff0f0">&quot;record.wav&quot;</span>) <span style="color: #888888">#Load the audio file</span>
                pygame<span style="color: #333333">.</span>mixer<span style="color: #333333">.</span>music<span style="color: #333333">.</span>play() <span style="color: #888888">#Play the audio file</span>
                <span style="color: #008800; font-weight: bold">while</span>(pygame<span style="color: #333333">.</span>mixer<span style="color: #333333">.</span>music<span style="color: #333333">.</span>get_busy() <span style="color: #333333">==</span> <span style="color: #008800; font-weight: bold">True</span>): <span style="color: #888888">#While the audio files is being played</span>
                    <span style="color: #008800; font-weight: bold">pass</span> <span style="color: #888888">#Pass</span>
                os<span style="color: #333333">.</span>system(<span style="background-color: #fff0f0">&#39;arecord --device=hw:2,0 -d 5 --format S16_LE --rate 44100 -c1 victimRecord.wav -V mono&#39;</span>) <span style="color: #888888">#System command to record from microphone</span>
            <span style="color: #008800; font-weight: bold">elif</span>(command <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;PLAY&quot;</span> <span style="color: #000000; font-weight: bold">and</span> prevCommand <span style="color: #333333">!=</span> <span style="background-color: #fff0f0">&quot;PLAY&quot;</span>): <span style="color: #888888">#If the new command is PLAY</span>
                GPIO<span style="color: #333333">.</span>output(motor1Pin1, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor1Pin2, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor2Pin1, GPIO<span style="color: #333333">.</span>LOW)
                GPIO<span style="color: #333333">.</span>output(motor2Pin2, GPIO<span style="color: #333333">.</span>LOW)
                pygame<span style="color: #333333">.</span>mixer<span style="color: #333333">.</span>music<span style="color: #333333">.</span>load(<span style="background-color: #fff0f0">&quot;victimRecord.wav&quot;</span>) <span style="color: #888888">#Load the audio file</span>
                pygame<span style="color: #333333">.</span>mixer<span style="color: #333333">.</span>music<span style="color: #333333">.</span>play() <span style="color: #888888">#Play the audio file</span>
            <span style="color: #008800; font-weight: bold">elif</span>(command <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;MAP&quot;</span> <span style="color: #000000; font-weight: bold">and</span> prevCommand <span style="color: #333333">!=</span> <span style="background-color: #fff0f0">&quot;MAP&quot;</span>): <span style="color: #888888">#If the new command is MAP</span>
                startMap() <span style="color: #888888">#Start mapping</span>
            <span style="color: #008800; font-weight: bold">elif</span>(command <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;INC&quot;</span>): <span style="color: #888888">#If the new command is INC</span>
                <span style="color: #008800; font-weight: bold">if</span> dutyCycle <span style="color: #333333">&lt;</span> <span style="color: #0000DD; font-weight: bold">100</span>: <span style="color: #888888">#If duty cycle is less than 100</span>
                    dutyCycle <span style="color: #333333">+=</span> <span style="color: #0000DD; font-weight: bold">1</span> <span style="color: #888888">#Increment duty cycle</span>
                    <span style="color: #888888">#Change duty cycle</span>
                    motor1PWM<span style="color: #333333">.</span>ChangeDutyCycle(dutyCycle)
                    motor2PWM<span style="color: #333333">.</span>ChangeDutyCycle(dutyCycle)
            <span style="color: #008800; font-weight: bold">elif</span>(command <span style="color: #333333">==</span> <span style="background-color: #fff0f0">&quot;DEC&quot;</span>): <span style="color: #888888">#If the new command is DEC</span>
                <span style="color: #008800; font-weight: bold">if</span> dutyCycle <span style="color: #333333">&gt;</span> <span style="color: #0000DD; font-weight: bold">40</span>: <span style="color: #888888">#If duty cycle is greater than 40</span>
                    dutyCycle <span style="color: #333333">-=</span> <span style="color: #0000DD; font-weight: bold">1</span> <span style="color: #888888">#Decrement duty cycle</span>
                    <span style="color: #888888">#Change duty cycle</span>
                    motor1PWM<span style="color: #333333">.</span>ChangeDutyCycle(dutyCycle)
                    motor2PWM<span style="color: #333333">.</span>ChangeDutyCycle(dutyCycle)
            
            prevCommand <span style="color: #333333">=</span> command <span style="color: #888888">#Change previous command</span>
            
            <span style="color: #008800; font-weight: bold">if</span>(time<span style="color: #333333">.</span>time() <span style="color: #333333">-</span> timeStamp <span style="color: #333333">&gt;</span> <span style="color: #6600EE; font-weight: bold">0.01</span>): <span style="color: #888888">#If the time elapsed is 1 millisecond</span>
                adc <span style="color: #333333">=</span> readAdc(<span style="color: #0000DD; font-weight: bold">0</span>, CLK, MISO, MOSI, CS) <span style="color: #888888">#Read ADC</span>
                <span style="color: #008800; font-weight: bold">try</span>:
                    tempVar <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">10</span> <span style="color: #333333">*</span> log(<span style="color: #0000DD; font-weight: bold">10000</span> <span style="color: #333333">*</span> (<span style="color: #0000DD; font-weight: bold">1024</span> <span style="color: #333333">/</span> (adc <span style="color: #333333">/</span> <span style="color: #6600EE; font-weight: bold">3.3</span>) <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span>), <span style="color: #0000DD; font-weight: bold">10</span>) <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">10</span> <span style="color: #888888">#Scale the temperature</span>
                    tempVar <span style="color: #333333">=</span> <span style="color: #007020">round</span>(tempVar, <span style="color: #0000DD; font-weight: bold">3</span>) <span style="color: #888888">#Round the temperature to 3 digits</span>
                <span style="color: #008800; font-weight: bold">except</span>: <span style="color: #888888">#If it throws an error</span>
                    <span style="color: #008800; font-weight: bold">pass</span>
                distVar <span style="color: #333333">=</span> <span style="color: #007020">round</span>(distance(), <span style="color: #0000DD; font-weight: bold">3</span>) <span style="color: #888888">#Fetch the distance and round it to 3 digits</span>
                <span style="color: #008800; font-weight: bold">if</span>(distVar <span style="color: #333333">&lt;</span> distToStop): <span style="color: #888888">#If the distance is less tha  threshold distance</span>
                    <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">&quot;Dist Stopping..&quot;</span>) <span style="color: #888888">#Print &quot;Dist Stopping..&quot;</span>
                timeStamp <span style="color: #333333">=</span> time<span style="color: #333333">.</span>time() <span style="color: #888888">#Update the timestamp</span>
    <span style="color: #008800; font-weight: bold">except</span> <span style="color: #FF0000; font-weight: bold">KeyboardInterrupt</span>: <span style="color: #888888">#If interrupted from keyboard</span>
        motor1PWM<span style="color: #333333">.</span>stop() <span style="color: #888888">#Stop the motor 1 PWM</span>
        motor2PWM<span style="color: #333333">.</span>stop() <span style="color: #888888">#Stop the motor 2 PWM</span>
        GPIO<span style="color: #333333">.</span>cleanup() <span style="color: #888888">#Cleanup GPIO</span>
        <span style="color: #007020">print</span>(<span style="background-color: #fff0f0">&quot;Exiting...&quot;</span>) <span style="color: #888888">#Print &quot;Exiting...&quot;</span>
        sys<span style="color: #333333">.</span>exit(<span style="color: #0000DD; font-weight: bold">0</span>) <span style="color: #888888">#Exit the program</span>
</pre></div>

<h5 style="text-align:justify;">MainCode.pde</h5>
<!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #888888">//Import libraries for TCP/IP</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.net.*</span><span style="color: #333333">;</span>
<span style="color: #008800; font-weight: bold">import</span> <span style="color: #0e84b5; font-weight: bold">java.io.*</span><span style="color: #333333">;</span>

ArrayList <span style="color: #333333">&lt;</span>Button<span style="color: #333333">&gt;</span> buttons <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> ArrayList<span style="color: #333333">&lt;</span>Button<span style="color: #333333">&gt;();</span> <span style="color: #888888">//Arraylist for buttons</span>

String hostname <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;10.49.74.93&quot;</span><span style="color: #333333">;</span> <span style="color: #888888">//IP address of the server to connect to</span>
<span style="color: #333399; font-weight: bold">int</span> port <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">8000</span><span style="color: #333333">;</span> <span style="color: #888888">//Port for the socket to connect to</span>

<span style="color: #333399; font-weight: bold">int</span> buttonSize <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">150</span><span style="color: #333333">;</span> <span style="color: #888888">//The default button size</span>
String command <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;STOP&quot;</span><span style="color: #333333">;</span> <span style="color: #888888">//The default command to send</span>
<span style="color: #333399; font-weight: bold">boolean</span> commLock <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">false</span><span style="color: #333333">;</span> <span style="color: #888888">//Flag for communication lock</span>

<span style="color: #333399; font-weight: bold">float</span> pixelVals<span style="color: #333333">[]</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">float</span><span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">64</span><span style="color: #333333">];</span> <span style="color: #888888">//Pixel array</span>
<span style="color: #333399; font-weight: bold">float</span> bicubics<span style="color: #333333">[][]</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> <span style="color: #333399; font-weight: bold">float</span><span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">32</span><span style="color: #333333">][</span><span style="color: #0000DD; font-weight: bold">32</span><span style="color: #333333">];</span> <span style="color: #888888">//Bicubics array</span>
color colorArray<span style="color: #333333">[]</span> <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> color<span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">1024</span><span style="color: #333333">];</span> <span style="color: #888888">//Colour array</span>

InputStreamReader reader<span style="color: #333333">;</span> <span style="color: #888888">//Input stream reader</span>
PrintWriter writer<span style="color: #333333">;</span> <span style="color: #888888">//Output print writer</span>

<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">setup</span><span style="color: #333333">(){</span> <span style="color: #888888">//The setup function</span>
  fullScreen<span style="color: #333333">();</span> <span style="color: #888888">//Setup screen to be full screen</span>
  orientation<span style="color: #333333">(</span>LANDSCAPE<span style="color: #333333">);</span> <span style="color: #888888">//Set the orientation to be landscape</span>
  frameRate<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">60</span><span style="color: #333333">);</span> <span style="color: #888888">//Set the frame rate to be 60 fps</span>
  <span style="color: #008800; font-weight: bold">try</span><span style="color: #333333">{</span> <span style="color: #888888">//Try</span>
    Socket socket <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Socket<span style="color: #333333">(</span>hostname<span style="color: #333333">,</span> port<span style="color: #333333">);</span> <span style="color: #888888">//Connect to the socket</span>
    InputStream input <span style="color: #333333">=</span> socket<span style="color: #333333">.</span><span style="color: #0000CC">getInputStream</span><span style="color: #333333">();</span> <span style="color: #888888">//Create the input stream to read incoming data</span>
    OutputStream output <span style="color: #333333">=</span> socket<span style="color: #333333">.</span><span style="color: #0000CC">getOutputStream</span><span style="color: #333333">();</span> <span style="color: #888888">//Create the output stream to write outgoing data</span>
    reader <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> InputStreamReader<span style="color: #333333">(</span>input<span style="color: #333333">);</span> <span style="color: #888888">//Attach the reader to the input stream</span>
    writer <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> PrintWriter<span style="color: #333333">(</span>output<span style="color: #333333">,</span> <span style="color: #008800; font-weight: bold">true</span><span style="color: #333333">);</span> <span style="color: #888888">//Attach the writer to the output stream</span>
  <span style="color: #333333">}</span>
  <span style="color: #008800; font-weight: bold">catch</span> <span style="color: #333333">(</span>Exception ex<span style="color: #333333">)</span> <span style="color: #333333">{</span> <span style="color: #888888">//Catch exception</span>
    textSize<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">20</span><span style="color: #333333">);</span> <span style="color: #888888">//Set the text size to be 20</span>
    fill<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">);</span> <span style="color: #888888">//Change colour to black</span>
    text<span style="color: #333333">(</span>ex<span style="color: #333333">.</span><span style="color: #0000CC">getMessage</span><span style="color: #333333">(),</span> <span style="color: #0000DD; font-weight: bold">5</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">20</span><span style="color: #333333">);</span> <span style="color: #888888">//Display the error message</span>
    println<span style="color: #333333">(</span>ex<span style="color: #333333">.</span><span style="color: #0000CC">getMessage</span><span style="color: #333333">());</span> <span style="color: #888888">//Print the error message</span>
  <span style="color: #333333">}</span>
  
  addButtons<span style="color: #333333">();</span> <span style="color: #888888">//Add all the buttons</span>
<span style="color: #333333">}</span>

<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">draw</span><span style="color: #333333">(){</span> <span style="color: #888888">//The draw function</span>
  background<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">255</span><span style="color: #333333">);</span> <span style="color: #888888">//Fill screen with white colour</span>
  
  <span style="color: #008800; font-weight: bold">try</span><span style="color: #333333">{</span> <span style="color: #888888">//Try</span>
    <span style="color: #333399; font-weight: bold">int</span> character<span style="color: #333333">;</span> <span style="color: #888888">//Character to be read</span>
    StringBuilder data <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> StringBuilder<span style="color: #333333">();</span> <span style="color: #888888">//String builder</span>
    character <span style="color: #333333">=</span> reader<span style="color: #333333">.</span><span style="color: #0000CC">read</span><span style="color: #333333">();</span> <span style="color: #888888">//Rad the character</span>
    <span style="color: #008800; font-weight: bold">while</span> <span style="color: #333333">((</span>character <span style="color: #333333">!=</span> <span style="color: #0000DD; font-weight: bold">10</span><span style="color: #333333">)</span> <span style="color: #333333">&amp;&amp;</span> <span style="color: #333333">((</span>character <span style="color: #333333">!=</span> <span style="color: #333333">-</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">)))</span> <span style="color: #333333">{</span> <span style="color: #888888">//Until the character is new line or null</span>
      data<span style="color: #333333">.</span><span style="color: #0000CC">append</span><span style="color: #333333">((</span><span style="color: #333399; font-weight: bold">char</span><span style="color: #333333">)</span> character<span style="color: #333333">);</span> <span style="color: #888888">//Append the character to the string builder</span>
      character <span style="color: #333333">=</span> reader<span style="color: #333333">.</span><span style="color: #0000CC">read</span><span style="color: #333333">();</span> <span style="color: #888888">//Read the next character</span>
    <span style="color: #333333">}</span>
    data<span style="color: #333333">.</span><span style="color: #0000CC">append</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;\n&quot;</span><span style="color: #333333">);</span> <span style="color: #888888">//Append a new line character</span>
    String receivedString <span style="color: #333333">=</span> data<span style="color: #333333">.</span><span style="color: #0000CC">toString</span><span style="color: #333333">();</span> <span style="color: #888888">//Convert to string</span>
    String dataArrays<span style="color: #333333">[]</span> <span style="color: #333333">=</span> receivedString<span style="color: #333333">.</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;;&quot;</span><span style="color: #333333">);</span> <span style="color: #888888">//Split the received string around the &quot;;&quot; character and store the resultant substrings into an array </span>
    String pixelArray<span style="color: #333333">[]</span> <span style="color: #333333">=</span> dataArrays<span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">].</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span> <span style="color: #888888">//Split the pixel array around the &quot;,&quot; character</span>
    String bicubicArray<span style="color: #333333">[]</span> <span style="color: #333333">=</span> dataArrays<span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">].</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span> <span style="color: #888888">//Split the bicubic array around the &quot;,&quot; character</span>
    String colArray<span style="color: #333333">[]</span> <span style="color: #333333">=</span> dataArrays<span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">].</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;:&quot;</span><span style="color: #333333">);</span> <span style="color: #888888">//Split the colour array around the &quot;:&quot; character</span>
    String sensorArray<span style="color: #333333">[]</span> <span style="color: #333333">=</span> dataArrays<span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">3</span><span style="color: #333333">].</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span> <span style="color: #888888">//Split the sensor array around the &quot;,&quot; character</span>
    
    fill<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">);</span> <span style="color: #888888">//Make the colour black</span>
    textSize<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">40</span><span style="color: #333333">);</span> <span style="color: #888888">//Set the text size to be 40</span>
    <span style="color: #888888">//Print the sensor strings on the screen</span>
    text<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Water: &quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">40</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">100</span><span style="color: #333333">);</span>
    text<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Fire: &quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">40</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">150</span><span style="color: #333333">);</span>
    text<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Radiation: &quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">40</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">200</span><span style="color: #333333">);</span>
    text<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Temperature: &quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">40</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">250</span><span style="color: #333333">);</span>
    text<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;Distance: &quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">40</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">300</span><span style="color: #333333">);</span>
    <span style="color: #888888">//Print the sensor values on the screen</span>
    <span style="color: #008800; font-weight: bold">for</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> sensorArray<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">;</span> i<span style="color: #333333">++){</span>
      text<span style="color: #333333">(</span>sensorArray<span style="color: #333333">[</span>i<span style="color: #333333">],</span> <span style="color: #0000DD; font-weight: bold">305</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">100</span> <span style="color: #333333">+</span> i <span style="color: #333333">*</span> <span style="color: #0000DD; font-weight: bold">50</span><span style="color: #333333">);</span>
    <span style="color: #333333">}</span>
    <span style="color: #888888">//Get pixel values</span>
    <span style="color: #008800; font-weight: bold">for</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> pixelVals<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">;</span> i<span style="color: #333333">++){</span>
      pixelVals<span style="color: #333333">[</span>i<span style="color: #333333">]</span> <span style="color: #333333">=</span> Float<span style="color: #333333">.</span><span style="color: #0000CC">parseFloat</span><span style="color: #333333">(</span>pixelArray<span style="color: #333333">[</span>i<span style="color: #333333">]);</span>
    <span style="color: #333333">}</span>
    <span style="color: #888888">//Get bicubic values</span>
    <span style="color: #008800; font-weight: bold">for</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> bicubics<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">;</span> i<span style="color: #333333">++){</span>
      <span style="color: #008800; font-weight: bold">for</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> j <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> j <span style="color: #333333">&lt;</span> bicubics<span style="color: #333333">[</span>i<span style="color: #333333">].</span><span style="color: #0000CC">length</span><span style="color: #333333">;</span> j<span style="color: #333333">++){</span>
        bicubics<span style="color: #333333">[</span>i<span style="color: #333333">][</span>j<span style="color: #333333">]</span> <span style="color: #333333">=</span> Float<span style="color: #333333">.</span><span style="color: #0000CC">parseFloat</span><span style="color: #333333">(</span>bicubicArray<span style="color: #333333">[</span>i <span style="color: #333333">*</span> bicubics<span style="color: #333333">.</span><span style="color: #0000CC">length</span> <span style="color: #333333">+</span> j<span style="color: #333333">]);</span>
      <span style="color: #333333">}</span>
    <span style="color: #333333">}</span>
    <span style="color: #888888">//Get colour values</span>
    <span style="color: #008800; font-weight: bold">for</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> colorArray<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">;</span> i<span style="color: #333333">++){</span>
      String redGreenBlue<span style="color: #333333">[]</span> <span style="color: #333333">=</span> colArray<span style="color: #333333">[</span>i<span style="color: #333333">].</span><span style="color: #0000CC">split</span><span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;,&quot;</span><span style="color: #333333">);</span>
      colorArray<span style="color: #333333">[</span>i<span style="color: #333333">]</span> <span style="color: #333333">=</span> color<span style="color: #333333">(</span>Integer<span style="color: #333333">.</span><span style="color: #0000CC">parseInt</span><span style="color: #333333">(</span>redGreenBlue<span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">].</span><span style="color: #0000CC">substring</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">).</span><span style="color: #0000CC">trim</span><span style="color: #333333">()),</span> Integer<span style="color: #333333">.</span><span style="color: #0000CC">parseInt</span><span style="color: #333333">(</span>redGreenBlue<span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">].</span><span style="color: #0000CC">trim</span><span style="color: #333333">()),</span> Integer<span style="color: #333333">.</span><span style="color: #0000CC">parseInt</span><span style="color: #333333">(</span>redGreenBlue<span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">].</span><span style="color: #0000CC">substring</span><span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">,</span> redGreenBlue<span style="color: #333333">[</span><span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">].</span><span style="color: #0000CC">length</span><span style="color: #333333">()</span> <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">).</span><span style="color: #0000CC">trim</span><span style="color: #333333">()));</span>
    <span style="color: #333333">}</span>
    <span style="color: #888888">//Do the colour printing magic to create the image in the screen</span>
    <span style="color: #008800; font-weight: bold">for</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> i <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> i <span style="color: #333333">&lt;</span> bicubics<span style="color: #333333">.</span><span style="color: #0000CC">length</span><span style="color: #333333">;</span> i<span style="color: #333333">++){</span>
      <span style="color: #008800; font-weight: bold">for</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> j <span style="color: #333333">=</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">;</span> j <span style="color: #333333">&lt;</span> bicubics<span style="color: #333333">[</span>i<span style="color: #333333">].</span><span style="color: #0000CC">length</span><span style="color: #333333">;</span> j<span style="color: #333333">++){</span>
        <span style="color: #333399; font-weight: bold">float</span> pixelVal <span style="color: #333333">=</span> bicubics<span style="color: #333333">[</span>i<span style="color: #333333">][</span>j<span style="color: #333333">];</span>
        fill<span style="color: #333333">(</span>colorArray<span style="color: #333333">[</span>myConstrain<span style="color: #333333">((</span><span style="color: #333399; font-weight: bold">int</span><span style="color: #333333">)</span> pixelVal<span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">1024</span> <span style="color: #333333">-</span> <span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">)]);</span>
        rect<span style="color: #333333">((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">((</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">30</span><span style="color: #333333">)</span> <span style="color: #333333">*</span> i<span style="color: #333333">),</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">30</span><span style="color: #333333">)</span> <span style="color: #333333">*</span> j<span style="color: #333333">,</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">30</span><span style="color: #333333">),</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">30</span><span style="color: #333333">));</span>
      <span style="color: #333333">}</span>
    <span style="color: #333333">}</span>
  <span style="color: #333333">}</span>
  <span style="color: #008800; font-weight: bold">catch</span> <span style="color: #333333">(</span>Exception ex<span style="color: #333333">)</span> <span style="color: #333333">{</span> <span style="color: #888888">//Catch exception</span>
    textSize<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">20</span><span style="color: #333333">);</span> <span style="color: #888888">//Set the text size to be 20</span>
    fill<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">);</span> <span style="color: #888888">//Change colour to black</span>
    text<span style="color: #333333">(</span><span style="background-color: #fff0f0">&quot;I/O error: &quot;</span> <span style="color: #333333">+</span> ex<span style="color: #333333">.</span><span style="color: #0000CC">getMessage</span><span style="color: #333333">(),</span> <span style="color: #0000DD; font-weight: bold">5</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">20</span><span style="color: #333333">);</span> <span style="color: #888888">//Display the error message</span>
    println<span style="color: #333333">(</span>ex<span style="color: #333333">.</span><span style="color: #0000CC">getMessage</span><span style="color: #333333">());</span> <span style="color: #888888">//Print the error message</span>
    <span style="color: #008800; font-weight: bold">try</span><span style="color: #333333">{</span> <span style="color: #888888">//Try</span>
      Socket socket <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> Socket<span style="color: #333333">(</span>hostname<span style="color: #333333">,</span> port<span style="color: #333333">);</span> <span style="color: #888888">//Connect to the socket</span>
      InputStream input <span style="color: #333333">=</span> socket<span style="color: #333333">.</span><span style="color: #0000CC">getInputStream</span><span style="color: #333333">();</span> <span style="color: #888888">//Create the input stream to read incoming data</span>
      OutputStream output <span style="color: #333333">=</span> socket<span style="color: #333333">.</span><span style="color: #0000CC">getOutputStream</span><span style="color: #333333">();</span> <span style="color: #888888">//Create the output stream to write outgoing data</span>
      reader <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> InputStreamReader<span style="color: #333333">(</span>input<span style="color: #333333">);</span> <span style="color: #888888">//Attach the reader to the input stream</span>
      writer <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">new</span> PrintWriter<span style="color: #333333">(</span>output<span style="color: #333333">,</span> <span style="color: #008800; font-weight: bold">true</span><span style="color: #333333">);</span> <span style="color: #888888">//Attach the writer to the output stream</span>
    <span style="color: #333333">}</span>
    <span style="color: #008800; font-weight: bold">catch</span> <span style="color: #333333">(</span>Exception ex1<span style="color: #333333">)</span> <span style="color: #333333">{</span> <span style="color: #888888">//Catch</span>
    <span style="color: #333333">}</span>
  <span style="color: #333333">}</span>
  <span style="color: #008800; font-weight: bold">if</span><span style="color: #333333">(!</span>commLock<span style="color: #333333">){</span> <span style="color: #888888">//If the command has not been locked</span>
    command <span style="color: #333333">=</span> <span style="background-color: #fff0f0">&quot;STOP&quot;</span><span style="color: #333333">;</span> <span style="color: #888888">//Make the default command &quot;&quot;STOP</span>
  <span style="color: #333333">}</span>
  <span style="color: #008800; font-weight: bold">try</span><span style="color: #333333">{</span> <span style="color: #888888">//Try</span>
    writer<span style="color: #333333">.</span><span style="color: #0000CC">println</span><span style="color: #333333">(</span>command<span style="color: #333333">);</span> <span style="color: #888888">//Send the command over to the TCP/IP socket</span>
  <span style="color: #333333">}</span>
  <span style="color: #008800; font-weight: bold">catch</span> <span style="color: #333333">(</span>Exception ex<span style="color: #333333">)</span> <span style="color: #333333">{</span> <span style="color: #888888">//Catch</span>
  <span style="color: #333333">}</span>
  <span style="color: #008800; font-weight: bold">for</span><span style="color: #333333">(</span>Button <span style="color: #997700; font-weight: bold">b:</span> buttons<span style="color: #333333">){</span> <span style="color: #888888">//For all the buttons</span>
    b<span style="color: #333333">.</span><span style="color: #0000CC">drawButton</span><span style="color: #333333">();</span> <span style="color: #888888">//Draw the button</span>
  <span style="color: #333333">}</span>
<span style="color: #333333">}</span>

<span style="color: #333399; font-weight: bold">int</span> <span style="color: #0066BB; font-weight: bold">myConstrain</span><span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> val<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> minVal<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> maxVal<span style="color: #333333">){</span> <span style="color: #888888">//Constraint function</span>
  <span style="color: #008800; font-weight: bold">return</span> <span style="color: #0066BB; font-weight: bold">min</span><span style="color: #333333">(</span>maxVal<span style="color: #333333">,</span> max<span style="color: #333333">(</span>minVal<span style="color: #333333">,</span> val<span style="color: #333333">));</span>
<span style="color: #333333">}</span>
</pre></div>

<h5 style="text-align:justify;">Button.pde</h5>
<!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-weight: bold">class</span> <span style="color: #BB0066; font-weight: bold">Button</span><span style="color: #333333">{</span> <span style="color: #888888">//The button class</span>
  String text<span style="color: #333333">;</span> <span style="color: #888888">//The text to be displayed</span>
  <span style="color: #333399; font-weight: bold">int</span> x<span style="color: #333333">,</span> y<span style="color: #333333">;</span> <span style="color: #888888">//x and y coordinates of the button</span>
  <span style="color: #333399; font-weight: bold">int</span> bLength<span style="color: #333333">,</span> bHeight<span style="color: #333333">;</span> <span style="color: #888888">//The button length and button height</span>
  
  Button<span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> xCor<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> yCor<span style="color: #333333">,</span> String bText<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> bl<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> bh<span style="color: #333333">){</span> <span style="color: #888888">//Constructor 1</span>
    x <span style="color: #333333">=</span> xCor<span style="color: #333333">;</span>
    y <span style="color: #333333">=</span> yCor<span style="color: #333333">;</span>
    text <span style="color: #333333">=</span> bText<span style="color: #333333">;</span>
    bLength <span style="color: #333333">=</span> bl<span style="color: #333333">;</span>
    bHeight <span style="color: #333333">=</span> bh<span style="color: #333333">;</span>
    
  <span style="color: #333333">}</span>
  Button<span style="color: #333333">(</span><span style="color: #333399; font-weight: bold">int</span> xCor<span style="color: #333333">,</span> <span style="color: #333399; font-weight: bold">int</span> yCor<span style="color: #333333">,</span> String bText<span style="color: #333333">){</span> <span style="color: #888888">//Constructor 2</span>
    x <span style="color: #333333">=</span> xCor<span style="color: #333333">;</span>
    y <span style="color: #333333">=</span> yCor<span style="color: #333333">;</span>
    text <span style="color: #333333">=</span> bText<span style="color: #333333">;</span>
    bLength <span style="color: #333333">=</span> buttonSize<span style="color: #333333">;</span>
    bHeight <span style="color: #333333">=</span> buttonSize<span style="color: #333333">;</span>
  <span style="color: #333333">}</span>
  
  <span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">drawButton</span><span style="color: #333333">(){</span> <span style="color: #888888">//Draw button</span>
    fill<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">127</span><span style="color: #333333">);</span> <span style="color: #888888">//Fill with grey</span>
    stroke<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">);</span> <span style="color: #888888">//Make border black</span>
    strokeWeight<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">3</span><span style="color: #333333">);</span> <span style="color: #888888">//Make border width 3</span>
    rect<span style="color: #333333">(</span>x<span style="color: #333333">,</span> y<span style="color: #333333">,</span> bLength<span style="color: #333333">,</span> bHeight<span style="color: #333333">);</span> <span style="color: #888888">//Draw rectangle</span>
    strokeWeight<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">1</span><span style="color: #333333">);</span> <span style="color: #888888">//Make border width 1</span>
    
    fill<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">0</span><span style="color: #333333">);</span> <span style="color: #888888">//Fill with black</span>
    textSize<span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">40</span><span style="color: #333333">);</span> <span style="color: #888888">//Make text size 40</span>
    text<span style="color: #333333">(</span>text<span style="color: #333333">,</span> x <span style="color: #333333">+</span> <span style="color: #333333">(</span>bLength <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>textWidth<span style="color: #333333">(</span>text<span style="color: #333333">)</span> <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">),</span> y <span style="color: #333333">+</span> <span style="color: #333333">(</span>bHeight <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>textAscent<span style="color: #333333">()</span> <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">));</span> <span style="color: #888888">//Print button text</span>
  <span style="color: #333333">}</span>
<span style="color: #333333">}</span>
</pre></div>

<h5 style="text-align:justify;">addButtonFunc.pde</h5>
<!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">addButtons</span><span style="color: #333333">(){</span> <span style="color: #888888">//The function to add buttons</span>
  buttons<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> Button<span style="color: #333333">((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">),</span> <span style="color: #0000DD; font-weight: bold">650</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;UP&quot;</span><span style="color: #333333">));</span>
  buttons<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> Button<span style="color: #333333">((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">),</span> <span style="color: #0000DD; font-weight: bold">850</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;DOWN&quot;</span><span style="color: #333333">));</span>
  buttons<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> Button<span style="color: #333333">((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">15</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">))</span> <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">),</span> <span style="color: #0000DD; font-weight: bold">850</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;LEFT&quot;</span><span style="color: #333333">));</span>
  buttons<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> Button<span style="color: #333333">((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">))</span> <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">),</span> <span style="color: #0000DD; font-weight: bold">850</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;RIGHT&quot;</span><span style="color: #333333">));</span>
  
  buttons<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> Button<span style="color: #333333">((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span><span style="color: #0000DD; font-weight: bold">3</span> <span style="color: #333333">*</span> buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">),</span> <span style="color: #0000DD; font-weight: bold">450</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;INC&quot;</span><span style="color: #333333">));</span>
  buttons<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> Button<span style="color: #333333">((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">),</span> <span style="color: #0000DD; font-weight: bold">450</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;DEC&quot;</span><span style="color: #333333">));</span>
  
  buttons<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> Button<span style="color: #333333">((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">15</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">))</span> <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">),</span> <span style="color: #0000DD; font-weight: bold">50</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;HELP&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">2</span> <span style="color: #333333">*</span> buttonSize <span style="color: #333333">+</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">5</span><span style="color: #333333">),</span> buttonSize<span style="color: #333333">));</span>
  buttons<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> Button<span style="color: #333333">((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">15</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">))</span> <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">),</span> <span style="color: #0000DD; font-weight: bold">250</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;RECORD&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">2</span> <span style="color: #333333">*</span> buttonSize <span style="color: #333333">+</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">5</span><span style="color: #333333">),</span> buttonSize<span style="color: #333333">));</span>
  buttons<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> Button<span style="color: #333333">((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">15</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">))</span> <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">),</span> <span style="color: #0000DD; font-weight: bold">450</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;PLAY&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">2</span> <span style="color: #333333">*</span> buttonSize <span style="color: #333333">+</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">5</span><span style="color: #333333">),</span> buttonSize<span style="color: #333333">));</span>
  buttons<span style="color: #333333">.</span><span style="color: #0000CC">add</span><span style="color: #333333">(</span><span style="color: #008800; font-weight: bold">new</span> Button<span style="color: #333333">((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">15</span><span style="color: #333333">)</span> <span style="color: #333333">+</span> <span style="color: #333333">(((</span>width <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>height <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">))</span> <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">4</span><span style="color: #333333">)</span> <span style="color: #333333">-</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">2</span><span style="color: #333333">),</span> <span style="color: #0000DD; font-weight: bold">650</span><span style="color: #333333">,</span> <span style="background-color: #fff0f0">&quot;MAP&quot;</span><span style="color: #333333">,</span> <span style="color: #0000DD; font-weight: bold">2</span> <span style="color: #333333">*</span> buttonSize <span style="color: #333333">+</span> <span style="color: #333333">(</span>buttonSize <span style="color: #333333">/</span> <span style="color: #0000DD; font-weight: bold">5</span><span style="color: #333333">),</span> buttonSize<span style="color: #333333">));</span>
<span style="color: #333333">}</span>
</pre></div>

<h5 style="text-align:justify;">mouseFunc.pde</h5>
<!-- HTML generated using hilite.me --><div style="background: #ffffff; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">mousePressed</span><span style="color: #333333">(){</span> <span style="color: #888888">//The mouse pressed function</span>
  <span style="color: #008800; font-weight: bold">for</span><span style="color: #333333">(</span>Button <span style="color: #997700; font-weight: bold">b:</span> buttons<span style="color: #333333">){</span> <span style="color: #888888">//For all buttons</span>
    <span style="color: #008800; font-weight: bold">if</span><span style="color: #333333">(</span>mouseX <span style="color: #333333">&gt;</span> b<span style="color: #333333">.</span><span style="color: #0000CC">x</span> <span style="color: #333333">&amp;&amp;</span> mouseX <span style="color: #333333">&lt;</span> b<span style="color: #333333">.</span><span style="color: #0000CC">x</span> <span style="color: #333333">+</span> b<span style="color: #333333">.</span><span style="color: #0000CC">bLength</span> <span style="color: #333333">&amp;&amp;</span> mouseY <span style="color: #333333">&gt;</span> b<span style="color: #333333">.</span><span style="color: #0000CC">y</span> <span style="color: #333333">&amp;&amp;</span> mouseY <span style="color: #333333">&lt;</span> b<span style="color: #333333">.</span><span style="color: #0000CC">y</span> <span style="color: #333333">+</span> b<span style="color: #333333">.</span><span style="color: #0000CC">bHeight</span><span style="color: #333333">){</span> <span style="color: #888888">//If this pressed</span>
      commLock <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">true</span><span style="color: #333333">;</span> <span style="color: #888888">//Lock the command flag</span>
      command <span style="color: #333333">=</span> b<span style="color: #333333">.</span><span style="color: #0000CC">text</span><span style="color: #333333">;</span> <span style="color: #888888">//Change the command to button</span>
      <span style="color: #008800; font-weight: bold">break</span><span style="color: #333333">;</span> <span style="color: #888888">//Break out of the loop</span>
    <span style="color: #333333">}</span>
  <span style="color: #333333">}</span>
<span style="color: #333333">}</span>

<span style="color: #333399; font-weight: bold">void</span> <span style="color: #0066BB; font-weight: bold">mouseReleased</span><span style="color: #333333">(){</span> <span style="color: #888888">//The mouse released function</span>
  commLock <span style="color: #333333">=</span> <span style="color: #008800; font-weight: bold">false</span><span style="color: #333333">;</span> <span style="color: #888888">//Unlock the command flag</span>
<span style="color: #333333">}</span>
</pre></div>

      </div>

    </div><!-- /.container -->




    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="../../assets/js/vendor/jquery.min.js"><\/script>')</script>
    <script src="dist/js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <!-- <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script> -->
  </body>
</html>